// Auto-generated experiment comparison plots
// Generated by generate_staleness_plots.py
// Prefix: code

const codeData = {
  "runs": [
    {
      "id": "original",
      "label": "Standard verifier",
      "color": "#3b82f6",
      "steps": [
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9,
        10,
        11,
        12,
        13,
        14,
        15,
        16,
        17,
        18,
        19,
        20,
        21,
        22,
        23,
        24,
        25,
        26,
        27,
        28,
        29,
        30,
        31,
        32,
        33,
        34,
        35,
        36,
        37,
        38,
        39,
        40,
        41,
        42,
        43,
        44,
        45,
        46,
        47,
        48,
        49,
        50,
        51,
        52,
        53,
        54,
        55,
        56,
        57,
        58,
        59,
        60,
        61,
        62,
        63,
        64,
        65,
        66,
        67,
        68,
        69,
        70,
        71,
        72,
        73,
        74,
        75,
        76,
        77,
        78,
        79,
        80,
        81,
        82,
        83,
        84,
        85,
        86,
        87,
        88,
        89,
        90,
        91,
        92,
        93,
        94,
        95,
        96,
        97,
        98,
        99,
        100,
        101,
        102,
        103,
        104,
        105,
        106,
        107,
        108,
        109,
        110,
        111,
        112,
        113,
        114,
        115,
        116,
        117,
        118,
        119,
        120,
        121,
        122,
        123,
        124,
        125,
        126,
        127,
        128,
        129,
        130,
        131,
        132,
        133,
        134,
        135,
        136,
        137,
        138,
        139,
        140
      ],
      "reward_overall": [
        0.4812680115273775,
        0.5389072847682119,
        0.6004464285714286,
        0.6004098360655737,
        0.48255813953488375,
        0.5148809523809523,
        0.5741421568627451,
        0.5330882352941176,
        0.5441176470588235,
        0.49489795918367346,
        0.5810439560439561,
        0.5985221674876847,
        0.5531088082901554,
        0.5355960264900662,
        0.6369047619047619,
        0.5981308411214953,
        0.6223544973544973,
        0.58125,
        0.476027397260274,
        0.6698275862068965,
        0.5836298932384342,
        0.5707831325301205,
        0.6805555555555556,
        0.6432160804020101,
        0.6305418719211823,
        0.5021186440677966,
        0.6804577464788732,
        0.6428571428571429,
        0.6031468531468531,
        0.6694078947368421,
        0.6859903381642513,
        0.682909604519774,
        0.669392523364486,
        0.7263681592039801,
        0.6712962962962963,
        0.6922169811320755,
        0.7337962962962963,
        0.7332214765100671,
        0.7491610738255033,
        0.7427536231884058,
        0.7574074074074074,
        0.7306701030927835,
        0.7709677419354839,
        0.7069672131147541,
        0.7551020408163265,
        0.7516339869281046,
        0.7518518518518519,
        0.7402777777777778,
        0.7636054421768708,
        0.7241379310344828,
        0.7542682926829268,
        0.7195945945945946,
        0.6951754385964912,
        0.7541866028708134,
        0.7377167630057804,
        0.755,
        0.7446682464454977,
        0.7519633507853403,
        0.7105263157894737,
        0.7199754901960784,
        0.6815,
        0.6818181818181818,
        0.5625,
        0.7109929078014184,
        0.66125,
        0.694371727748691,
        0.6623134328358209,
        0.7364130434782609,
        0.7126777251184834,
        0.7126225490196079,
        0.698019801980198,
        0.7373853211009175,
        0.76953125,
        0.7244318181818182,
        0.7326732673267327,
        0.7541469194312796,
        0.7598039215686274,
        0.7740825688073395,
        0.78375,
        0.7484939759036144,
        0.7774390243902439,
        0.7473821989528796,
        0.7904676258992805,
        0.7559931506849316,
        0.7752463054187192,
        0.7152255639097744,
        0.7340425531914894,
        0.7389534883720931,
        0.7336956521739131,
        0.5721830985915493,
        0.6777522935779816,
        0.736046511627907,
        0.6953947368421053,
        0.689453125,
        0.7089201877934272,
        0.7125603864734299,
        0.6959677419354838,
        0.6162790697674418,
        0.7227822580645161,
        0.7434834123222749,
        0.6786616161616161,
        0.625,
        0.7283834586466166,
        0.7344444444444445,
        0.7270408163265306,
        0.6692708333333334,
        0.709070796460177,
        0.7288647342995169,
        0.7254901960784313,
        0.6629746835443038,
        0.7449324324324325,
        0.7233412322274881,
        0.6895734597156398,
        0.6933962264150944,
        0.6432291666666666,
        0.6538461538461539,
        0.6958333333333333,
        0.6231884057971014,
        0.6567567567567567,
        0.594,
        0.575,
        0.5865384615384616,
        0.6364213197969543,
        0.611328125,
        0.6199494949494949,
        0.6241007194244604,
        0.6088709677419355,
        0.6512096774193549,
        0.6453862660944206,
        0.6494318181818182,
        0.6707474226804123,
        0.6371527777777778,
        0.6909090909090909,
        0.6409883720930233,
        0.7515957446808511,
        0.6901162790697675,
        0.6875,
        0.6891025641025641,
        0.6305309734513275,
        0.6938259109311741
      ],
      "frac_all_correct": [
        0.08069164265129683,
        0.13245033112582782,
        0.16517857142857142,
        0.13114754098360656,
        0.06976744186046512,
        0.14285714285714285,
        0.21568627450980393,
        0.1568627450980392,
        0.15508021390374332,
        0.04081632653061224,
        0.27472527472527475,
        0.2512315270935961,
        0.20725388601036268,
        0.1390728476821192,
        0.2857142857142857,
        0.2803738317757009,
        0.25925925925925924,
        0.18333333333333332,
        0.0821917808219178,
        0.47586206896551725,
        0.3096085409252669,
        0.13253012048192772,
        0.4074074074074074,
        0.4120603015075377,
        0.3399014778325123,
        0.15254237288135594,
        0.43661971830985913,
        0.35467980295566504,
        0.3076923076923077,
        0.34210526315789475,
        0.4492753623188406,
        0.4519774011299435,
        0.4205607476635514,
        0.5024875621890548,
        0.4074074074074074,
        0.4056603773584906,
        0.5462962962962963,
        0.47651006711409394,
        0.5771812080536913,
        0.5362318840579711,
        0.48148148148148145,
        0.5567010309278351,
        0.4967741935483871,
        0.4918032786885246,
        0.5153061224489796,
        0.5294117647058824,
        0.4962962962962963,
        0.48333333333333334,
        0.47619047619047616,
        0.46551724137931033,
        0.4926829268292683,
        0.3918918918918919,
        0.37719298245614036,
        0.47368421052631576,
        0.3815028901734104,
        0.4266666666666667,
        0.46919431279620855,
        0.47643979057591623,
        0.3473684210526316,
        0.36764705882352944,
        0.312,
        0.14285714285714285,
        0.029411764705882353,
        0.3617021276595745,
        0.3,
        0.27225130890052357,
        0.14925373134328357,
        0.34782608695652173,
        0.33175355450236965,
        0.3333333333333333,
        0.26732673267326734,
        0.3944954128440367,
        0.4739583333333333,
        0.3806818181818182,
        0.4158415841584158,
        0.4928909952606635,
        0.4852941176470588,
        0.5229357798165137,
        0.55,
        0.46987951807228917,
        0.6016260162601627,
        0.49214659685863876,
        0.5035971223021583,
        0.4863013698630137,
        0.47783251231527096,
        0.3157894736842105,
        0.35106382978723405,
        0.42790697674418604,
        0.3695652173913043,
        0.11267605633802817,
        0.3761467889908257,
        0.44651162790697674,
        0.3105263157894737,
        0.34375,
        0.3474178403755869,
        0.30917874396135264,
        0.23225806451612904,
        0.06976744186046512,
        0.3951612903225806,
        0.4028436018957346,
        0.2676767676767677,
        0.18181818181818182,
        0.3609022556390977,
        0.3466666666666667,
        0.3010204081632653,
        0.14583333333333334,
        0.3805309734513274,
        0.34299516908212563,
        0.29411764705882354,
        0.12658227848101267,
        0.3108108108108108,
        0.2985781990521327,
        0.23696682464454977,
        0.18238993710691823,
        0.041666666666666664,
        0.23076923076923078,
        0.18571428571428572,
        0.1111111111111111,
        0.13513513513513514,
        0.12,
        0.05,
        0.10576923076923077,
        0.1319796954314721,
        0.11328125,
        0.08585858585858586,
        0.10071942446043165,
        0.04838709677419355,
        0.1935483870967742,
        0.15450643776824036,
        0.14545454545454545,
        0.18041237113402062,
        0.09722222222222222,
        0.14545454545454545,
        0.2558139534883721,
        0.3276595744680851,
        0.24651162790697675,
        0.12903225806451613,
        0.10256410256410256,
        0.19469026548672566,
        0.15789473684210525
      ],
      "frac_all_wrong": [
        0.19596541786743515,
        0.07947019867549669,
        0.08482142857142858,
        0.02459016393442623,
        0.023255813953488372,
        0.17857142857142858,
        0.12254901960784313,
        0.14705882352941177,
        0.0962566844919786,
        0.04081632653061224,
        0.15384615384615385,
        0.1330049261083744,
        0.17098445595854922,
        0.11258278145695365,
        0.1111111111111111,
        0.18691588785046728,
        0.1164021164021164,
        0.10833333333333334,
        0.1232876712328767,
        0.16551724137931034,
        0.18505338078291814,
        0.07228915662650602,
        0.1111111111111111,
        0.18090452261306533,
        0.14285714285714285,
        0.11864406779661017,
        0.18309859154929578,
        0.13793103448275862,
        0.13286713286713286,
        0.09210526315789473,
        0.14009661835748793,
        0.1638418079096045,
        0.1308411214953271,
        0.14427860696517414,
        0.15343915343915343,
        0.16037735849056603,
        0.1527777777777778,
        0.1476510067114094,
        0.15436241610738255,
        0.1497584541062802,
        0.0962962962962963,
        0.15979381443298968,
        0.10967741935483871,
        0.1557377049180328,
        0.11734693877551021,
        0.0915032679738562,
        0.13333333333333333,
        0.12777777777777777,
        0.09523809523809523,
        0.14655172413793102,
        0.1024390243902439,
        0.10810810810810811,
        0.14035087719298245,
        0.10047846889952153,
        0.07514450867052024,
        0.06666666666666667,
        0.13270142180094788,
        0.10471204188481675,
        0.08421052631578947,
        0.12254901960784313,
        0.096,
        0.025974025974025976,
        0.029411764705882353,
        0.1276595744680851,
        0.115,
        0.06282722513089005,
        0.04477611940298507,
        0.08695652173913043,
        0.10426540284360189,
        0.06372549019607843,
        0.0891089108910891,
        0.11926605504587157,
        0.09375,
        0.11363636363636363,
        0.07920792079207921,
        0.10426540284360189,
        0.08333333333333333,
        0.11009174311926606,
        0.105,
        0.0963855421686747,
        0.12195121951219512,
        0.13089005235602094,
        0.08633093525179857,
        0.13013698630136986,
        0.08866995073891626,
        0.07518796992481203,
        0.09574468085106383,
        0.13023255813953488,
        0.059782608695652176,
        0.07042253521126761,
        0.12844036697247707,
        0.10232558139534884,
        0.08947368421052632,
        0.09375,
        0.107981220657277,
        0.07246376811594203,
        0.05806451612903226,
        0.023255813953488372,
        0.11290322580645161,
        0.0995260663507109,
        0.08080808080808081,
        0.11363636363636363,
        0.11278195488721804,
        0.09333333333333334,
        0.04591836734693878,
        0.020833333333333332,
        0.1415929203539823,
        0.09178743961352658,
        0.058823529411764705,
        0.06329113924050633,
        0.05405405405405406,
        0.12796208530805686,
        0.07582938388625593,
        0.0440251572327044,
        0.041666666666666664,
        0.14423076923076922,
        0.0761904761904762,
        0.07246376811594203,
        0.05405405405405406,
        0.04,
        0.025,
        0.16346153846153846,
        0.08121827411167512,
        0.0703125,
        0.04040404040404041,
        0.0,
        0.03225806451612903,
        0.08064516129032258,
        0.09871244635193133,
        0.07272727272727272,
        0.05670103092783505,
        0.020833333333333332,
        0.0,
        0.13953488372093023,
        0.08936170212765958,
        0.07906976744186046,
        0.03225806451612903,
        0.0,
        0.168141592920354,
        0.06882591093117409
      ],
      "completion_len": [
        326.75,
        428.0,
        390.6875,
        382.75,
        366.3125,
        322.0625,
        224.4375,
        268.5625,
        364.375,
        349.0,
        384.8125,
        311.125,
        268.3125,
        312.375,
        237.3125,
        249.3125,
        219.1875,
        311.9375,
        325.3125,
        241.6875,
        203.0,
        326.4375,
        202.1875,
        242.9375,
        205.8125,
        232.75,
        131.5625,
        142.625,
        163.25,
        51.0625,
        83.0,
        59.125,
        60.4375,
        72.5,
        114.3125,
        77.875,
        51.5,
        79.3125,
        52.6875,
        94.4375,
        54.1875,
        127.8125,
        93.75,
        59.125,
        43.6875,
        53.375,
        43.625,
        42.5,
        86.5,
        106.1875,
        76.3125,
        56.25,
        69.0,
        47.5625,
        48.3125,
        34.875,
        75.1875,
        66.125,
        51.8125,
        101.875,
        101.4375,
        80.125,
        78.25,
        44.5625,
        109.5625,
        148.25,
        61.625,
        50.875,
        46.5,
        60.375,
        80.625,
        79.75,
        69.4375,
        59.1875,
        61.8125,
        86.1875,
        87.0625,
        85.375,
        93.875,
        52.75,
        81.9375,
        69.375,
        149.375,
        115.3125,
        98.125,
        137.5625,
        109.125,
        161.625,
        158.0,
        114.1875,
        177.4375,
        160.375,
        158.1875,
        102.25,
        156.4375,
        233.0,
        153.125,
        285.0625,
        241.875,
        152.875,
        192.125,
        342.25,
        282.3125,
        212.25,
        232.4375,
        234.125,
        147.0625,
        129.0,
        125.0625,
        141.5,
        92.8125,
        152.3125,
        87.9375,
        109.3125,
        136.625,
        118.875,
        154.4375,
        121.3125,
        131.0625,
        185.125,
        216.75,
        198.875,
        281.25,
        283.125,
        219.625,
        313.9375,
        274.3125,
        357.125,
        183.375,
        248.3125,
        56.9375,
        154.8125,
        130.3125,
        191.25,
        108.875,
        72.625,
        221.8125,
        318.6875,
        221.0,
        128.8125
      ],
      "loss": [
        -2.7897069230675697e-05,
        -3.8853613659739494e-05,
        0.00018709897994995117,
        0.00035997387021780014,
        0.000729819294065237,
        0.0015241634100675583,
        0.0009964886121451855,
        0.0008635688573122025,
        0.00047704530879855156,
        0.000420308206230402,
        0.001329672522842884,
        0.0006746109575033188,
        0.0007324737962335348,
        0.0003607827238738537,
        0.0006571491248905659,
        0.00033338251523673534,
        0.0005173413082957268,
        0.0005181650631129742,
        0.0002709762193262577,
        0.001739418599754572,
        9.81984194368124e-05,
        0.0004936547484248877,
        0.00015411479398608208,
        0.00026616547256708145,
        -3.607245162129402e-06,
        -0.00011247536167502403,
        0.0006417275872081518,
        -0.00022492138668894768,
        0.0002961128484457731,
        0.0004503014497458935,
        -0.0007608670275658369,
        -0.0002548866905272007,
        -0.0007703008595854044,
        6.610294803977013e-06,
        -0.00041915872134268284,
        0.0012195783201605082,
        0.00038746953941881657,
        -0.0002334939781576395,
        0.0010892241261899471,
        0.0006363044958561659,
        0.0013759781140834093,
        0.0013490510173141956,
        -4.963576793670654e-05,
        0.0018016721587628126,
        0.002637332072481513,
        0.000276070786640048,
        0.0032865735702216625,
        0.003039364470168948,
        0.0008274819701910019,
        0.00022538518533110619,
        0.0021888171322643757,
        0.0015533051919192076,
        0.001890848157927394,
        0.0014545288868248463,
        0.00031877681612968445,
        0.0011343751102685928,
        0.0013591255992650986,
        0.39158877125009894,
        0.0007145567797124386,
        0.0033794904593378305,
        0.0005017730873078108,
        0.0010865351650863886,
        0.003535937052220106,
        0.0006032309029251337,
        0.0015414874069392681,
        0.0013356285635381937,
        0.001199432648718357,
        0.0002596054691821337,
        0.0014348705299198627,
        0.0027818402741104364,
        0.0007492315489798784,
        0.004109238274395466,
        0.0019587669521570206,
        0.0023090119939297438,
        0.00848860526457429,
        0.002052637282758951,
        0.0007459183689206839,
        0.0023318915627896786,
        0.0033054735977202654,
        0.002868877723813057,
        0.056739289313554764,
        0.0012253867462277412,
        0.0023545450530946255,
        0.0020593595691025257,
        0.0013206361327320337,
        0.00029624439775943756,
        0.001918441615998745,
        0.0008241035975515842,
        0.0013120046351104975,
        0.0015295329503715038,
        0.0008749424014240503,
        0.0007577040232717991,
        0.0012818537652492523,
        0.0002068511676043272,
        5.099410191178322e-05,
        0.001060596900060773,
        0.000950842397287488,
        0.0011173523962497711,
        0.002549937227740884,
        0.0006181418430060148,
        0.0007765479385852814,
        0.001095534535124898,
        0.0013404369819909334,
        0.00047266483306884766,
        0.0007269668858498335,
        0.0016672194469720125,
        0.0029010064899921417,
        0.0019974808674305677,
        0.0017560329288244247,
        0.0019143361132591963,
        0.0010601321700960398,
        0.0019276721868664026,
        0.0021761897951364517,
        0.0017861693631857634,
        0.0026964531280100346,
        0.004586243769153953,
        0.0024780130479484797,
        0.0035072576720267534,
        0.002438163384795189,
        0.0017776084132492542,
        0.0025128088891506195,
        0.003575700568035245,
        0.0026589015033096075,
        0.001976270927116275,
        0.0013859227765351534,
        0.0021821437403559685,
        0.0015181207563728094,
        0.003069402417168021,
        0.0014497111551463604,
        0.0003998083993792534,
        0.0010388586670160294,
        0.0003970707766711712,
        0.00023289164528250694,
        0.0019597839564085007,
        0.0012832183856517076,
        0.0013783827889710665,
        0.00028390949591994286,
        -0.00019572139717638493,
        0.0048939192201942205,
        0.0008925809524953365
      ],
      "loss_grpo": [
        -2.7897069230675697e-05,
        -3.8853613659739494e-05,
        0.00018709897994995117,
        0.00035997387021780014,
        0.000729819294065237,
        0.0015241634100675583,
        0.0009964886121451855,
        0.0008635688573122025,
        0.00047704530879855156,
        0.000420308206230402,
        0.001329672522842884,
        0.0006746109575033188,
        0.0007324737962335348,
        0.0003607827238738537,
        0.0006571491248905659,
        0.00033338251523673534,
        0.0005173413082957268,
        0.0005181650631129742,
        0.0002709762193262577,
        0.001739418599754572,
        9.81984194368124e-05,
        0.0004936547484248877,
        0.00015411479398608208,
        0.00026616547256708145,
        -3.607245162129402e-06,
        -0.00011247536167502403,
        0.0006417275872081518,
        -0.00022492138668894768,
        0.0002961128484457731,
        0.0004503014497458935,
        -0.0007608670275658369,
        -0.0002548866905272007,
        -0.0007703008595854044,
        6.610294803977013e-06,
        -0.00041915872134268284,
        0.0012195783201605082,
        0.00038746953941881657,
        -0.0002334939781576395,
        0.0010892241261899471,
        0.0006363044958561659,
        0.0013759781140834093,
        0.0013490510173141956,
        -4.963576793670654e-05,
        0.0018016721587628126,
        0.002637332072481513,
        0.000276070786640048,
        0.0032865735702216625,
        0.003039364470168948,
        0.0008274819701910019,
        0.00022538518533110619,
        0.0021888171322643757,
        0.0015533051919192076,
        0.001890848157927394,
        0.0014545288868248463,
        0.00031877681612968445,
        0.0011343751102685928,
        0.0013591255992650986,
        0.39158877125009894,
        0.0007145567797124386,
        0.0033794904593378305,
        0.0005017730873078108,
        0.0010865351650863886,
        0.003535937052220106,
        0.0006032309029251337,
        0.0015414874069392681,
        0.0013356285635381937,
        0.001199432648718357,
        0.0002596054691821337,
        0.0014348705299198627,
        0.0027818402741104364,
        0.0007492315489798784,
        0.004109238274395466,
        0.0019587669521570206,
        0.0023090119939297438,
        0.00848860526457429,
        0.002052637282758951,
        0.0007459183689206839,
        0.0023318915627896786,
        0.0033054735977202654,
        0.002868877723813057,
        0.056739289313554764,
        0.0012253867462277412,
        0.0023545450530946255,
        0.0020593595691025257,
        0.0013206361327320337,
        0.00029624439775943756,
        0.001918441615998745,
        0.0008241035975515842,
        0.0013120046351104975,
        0.0015295329503715038,
        0.0008749424014240503,
        0.0007577040232717991,
        0.0012818537652492523,
        0.0002068511676043272,
        5.099410191178322e-05,
        0.001060596900060773,
        0.000950842397287488,
        0.0011173523962497711,
        0.002549937227740884,
        0.0006181418430060148,
        0.0007765479385852814,
        0.001095534535124898,
        0.0013404369819909334,
        0.00047266483306884766,
        0.0007269668858498335,
        0.0016672194469720125,
        0.0029010064899921417,
        0.0019974808674305677,
        0.0017560329288244247,
        0.0019143361132591963,
        0.0010601321700960398,
        0.0019276721868664026,
        0.0021761897951364517,
        0.0017861693631857634,
        0.0026964531280100346,
        0.004586243769153953,
        0.0024780130479484797,
        0.0035072576720267534,
        0.002438163384795189,
        0.0017776084132492542,
        0.0025128088891506195,
        0.003575700568035245,
        0.0026589015033096075,
        0.001976270927116275,
        0.0013859227765351534,
        0.0021821437403559685,
        0.0015181207563728094,
        0.003069402417168021,
        0.0014497111551463604,
        0.0003998083993792534,
        0.0010388586670160294,
        0.0003970707766711712,
        0.00023289164528250694,
        0.0019597839564085007,
        0.0012832183856517076,
        0.0013783827889710665,
        0.00028390949591994286,
        -0.00019572139717638493,
        0.0048939192201942205,
        0.0008925809524953365
      ],
      "loss_sft": [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      "kl_mean": [
        1.06716315713129e-05,
        0.0017640490550547838,
        0.0047422414645552635,
        0.008762537501752377,
        0.01815114915370941,
        0.035064928233623505,
        0.045466821640729904,
        0.05671747773885727,
        0.04493849724531174,
        0.048411235213279724,
        0.04629938676953316,
        0.06048143655061722,
        0.06669645011425018,
        0.04928900673985481,
        0.08918275684118271,
        0.08014900237321854,
        0.09558650851249695,
        0.07395468652248383,
        0.06099317967891693,
        0.08092330396175385,
        0.08226278424263,
        0.04893266782164574,
        0.05875946208834648,
        0.05717691034078598,
        0.07766937464475632,
        0.05692668631672859,
        0.06732694059610367,
        0.0879632830619812,
        0.04415561631321907,
        0.23457856476306915,
        0.06814942508935928,
        0.14481481909751892,
        0.10999641567468643,
        0.11655895411968231,
        0.07060753554105759,
        0.1492399424314499,
        0.13862180709838867,
        0.10988897830247879,
        0.1243567019701004,
        0.06551340967416763,
        0.13442286849021912,
        0.04401819407939911,
        0.08499588817358017,
        0.1706826239824295,
        0.13472653925418854,
        0.11550308018922806,
        0.1103818416595459,
        0.14613965153694153,
        0.15374231338500977,
        0.045619767159223557,
        0.10390625149011612,
        0.1273147016763687,
        0.09116415679454803,
        0.11350271105766296,
        0.10388655960559845,
        0.3424476385116577,
        0.10232024639844894,
        0.20058032870292664,
        0.2487274557352066,
        0.09409149736166,
        0.08729279041290283,
        0.10833937674760818,
        0.13734544813632965,
        0.201482892036438,
        0.10294760018587112,
        0.07109353691339493,
        0.18935297429561615,
        0.16307981312274933,
        0.2876672148704529,
        0.18894019722938538,
        0.13943205773830414,
        0.13254620134830475,
        0.1574418842792511,
        0.3160068988800049,
        0.2820878028869629,
        0.25030577182769775,
        0.32315146923065186,
        0.19404737651348114,
        0.23474209010601044,
        0.4784606993198395,
        0.220022514462471,
        0.2634764015674591,
        0.14675270020961761,
        0.16717585921287537,
        0.22338420152664185,
        0.20217160880565643,
        0.2682892680168152,
        0.17350271344184875,
        0.16903026401996613,
        0.29734528064727783,
        0.2322428971529007,
        0.1451285481452942,
        0.1581452488899231,
        0.20333629846572876,
        0.16282756626605988,
        0.12508006393909454,
        0.2033846378326416,
        0.13605982065200806,
        0.13667279481887817,
        0.21096894145011902,
        0.17553149163722992,
        0.08674496412277222,
        0.14151743054389954,
        0.18402239680290222,
        0.2085769921541214,
        0.1871991753578186,
        0.2594076693058014,
        0.30112165212631226,
        0.28296056389808655,
        0.33065637946128845,
        0.36084043979644775,
        0.2741107642650604,
        0.4532751739025116,
        0.36801576614379883,
        0.373924195766449,
        0.38622787594795227,
        0.4222453832626343,
        0.38099977374076843,
        0.405711829662323,
        0.3804502785205841,
        0.3716844320297241,
        0.33001112937927246,
        0.3172052204608917,
        0.2645907998085022,
        0.2818097472190857,
        0.2450486123561859,
        0.268696665763855,
        0.21818438172340393,
        0.3714560568332672,
        0.1794593185186386,
        0.5635905265808105,
        0.3482745885848999,
        0.5125460624694824,
        0.3672753572463989,
        0.4760330617427826,
        0.4687764048576355,
        0.4558887481689453,
        0.3061143755912781,
        0.46321797370910645,
        0.49553534388542175
      ],
      "entropy_mean": [
        0.3793673515319824,
        0.23415732383728027,
        0.22057107090950012,
        0.3254215121269226,
        0.3327745497226715,
        0.39980849623680115,
        0.3609468340873718,
        0.37953460216522217,
        0.381626695394516,
        0.30489712953567505,
        0.24121281504631042,
        0.319209486246109,
        0.326759397983551,
        0.29128777980804443,
        0.28439122438430786,
        0.26105180382728577,
        0.27561601996421814,
        0.30129849910736084,
        0.26537516713142395,
        0.22966206073760986,
        0.21568940579891205,
        0.21250009536743164,
        0.20249275863170624,
        0.2347739189863205,
        0.3176438510417938,
        0.25617319345474243,
        0.26128342747688293,
        0.2751980721950531,
        0.187322735786438,
        0.20297378301620483,
        0.1465252935886383,
        0.201612651348114,
        0.12050282210111618,
        0.09461094439029694,
        0.22964686155319214,
        0.15591734647750854,
        0.15822811424732208,
        0.2094378024339676,
        0.20379075407981873,
        0.14525356888771057,
        0.19593286514282227,
        0.08635411411523819,
        0.15321005880832672,
        0.10235822200775146,
        0.20763197541236877,
        0.16215679049491882,
        0.20254985988140106,
        0.2272743284702301,
        0.19875496625900269,
        0.1161435917019844,
        0.2471812665462494,
        0.21499569714069366,
        0.1386888325214386,
        0.16074934601783752,
        0.1395592838525772,
        0.14978013932704926,
        0.19611750543117523,
        0.13529089093208313,
        0.2746405303478241,
        0.17941677570343018,
        0.2042725384235382,
        0.22888082265853882,
        0.417276531457901,
        0.36277633905410767,
        0.32958081364631653,
        0.1619417369365692,
        0.3285883665084839,
        0.21303138136863708,
        0.3226153552532196,
        0.3362659215927124,
        0.28938058018684387,
        0.24060235917568207,
        0.2055392563343048,
        0.30021610856056213,
        0.36222025752067566,
        0.2684639096260071,
        0.23686747252941132,
        0.24144630134105682,
        0.21829719841480255,
        0.3775118291378021,
        0.3108910620212555,
        0.3947005569934845,
        0.30301517248153687,
        0.2442718744277954,
        0.39391028881073,
        0.38704073429107666,
        0.6203986406326294,
        0.41132479906082153,
        0.47437238693237305,
        0.6159748435020447,
        0.49636098742485046,
        0.43823859095573425,
        0.5429995059967041,
        0.6095188856124878,
        0.5937959551811218,
        0.5070712566375732,
        0.6910153031349182,
        0.610298752784729,
        0.629832923412323,
        0.8861386179924011,
        0.6332494020462036,
        0.44481056928634644,
        0.6644680500030518,
        0.7156981229782104,
        0.7319431900978088,
        0.7263714075088501,
        1.0740946531295776,
        1.0702509880065918,
        1.0983548164367676,
        1.236536979675293,
        1.0952661037445068,
        0.9461723566055298,
        1.3704510927200317,
        1.406778335571289,
        1.3988733291625977,
        1.407457709312439,
        1.682936429977417,
        1.2122085094451904,
        1.3201848268508911,
        1.0586329698562622,
        1.4251283407211304,
        1.1002871990203857,
        1.1142090559005737,
        0.9198315739631653,
        0.9192630052566528,
        0.7565532326698303,
        0.9555997252464294,
        0.749282717704773,
        1.1018822193145752,
        0.6820346713066101,
        1.1783939599990845,
        1.4880893230438232,
        1.44525146484375,
        1.2685197591781616,
        1.862278699874878,
        1.4617468118667603,
        1.7658509016036987,
        1.6707736253738403,
        2.0046095848083496,
        1.9763915538787842
      ],
      "eval_humaneval_steps": [
        20,
        40,
        60,
        80,
        100,
        120,
        140
      ],
      "eval_humaneval_accuracy": [
        0.4878048780487805,
        0.5792682926829268,
        0.5,
        0.5,
        0.4024390243902439,
        0.4146341463414634,
        0.29878048780487804
      ],
      "eval_mbpp_test_steps": [
        20,
        40,
        60,
        80,
        100,
        120,
        140
      ],
      "eval_mbpp_test_accuracy": [
        0.6684491978609626,
        0.8101604278074866,
        0.7967914438502673,
        0.8556149732620321,
        0.839572192513369,
        0.8101604278074866,
        0.8342245989304813
      ]
    },
    {
      "id": "truncated",
      "label": "Truncated verifier",
      "color": "#f97316",
      "steps": [
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9,
        10,
        11,
        12,
        13,
        14,
        15,
        16,
        17,
        18,
        19,
        20,
        21,
        22,
        23,
        24,
        25,
        26,
        27,
        28,
        29,
        30,
        31,
        32,
        33,
        34,
        35,
        36,
        37,
        38,
        39,
        40,
        41,
        42,
        43,
        44,
        45,
        46,
        47,
        48,
        49,
        50,
        51,
        52,
        53,
        54,
        55,
        56,
        57,
        58,
        59,
        60,
        61,
        62,
        63,
        64,
        65,
        66,
        67,
        68,
        69,
        70,
        71,
        72,
        73,
        74,
        75,
        76,
        77,
        78,
        79,
        80,
        81,
        82,
        83,
        84,
        85,
        86,
        87,
        88,
        89,
        90,
        91,
        92,
        93,
        94,
        95,
        96,
        97,
        98,
        99,
        100,
        101,
        102,
        103,
        104,
        105,
        106,
        107,
        108,
        109,
        110,
        111,
        112,
        113,
        114,
        115,
        116,
        117,
        118,
        119,
        120,
        121,
        122,
        123,
        124,
        125,
        126,
        127,
        128,
        129,
        130,
        131,
        132,
        133,
        134,
        135,
        136,
        137,
        138,
        139,
        140,
        141,
        142,
        143,
        144,
        145,
        146,
        147,
        148,
        149,
        150,
        151,
        152,
        153,
        154,
        155,
        156,
        157,
        158,
        159,
        160,
        161,
        162,
        163,
        164,
        165,
        166,
        167,
        168,
        169,
        170,
        171,
        172,
        173,
        174,
        175,
        176,
        177,
        178,
        179,
        180,
        181,
        182,
        183,
        184,
        185,
        186,
        187,
        188,
        189,
        190,
        191,
        192,
        193,
        194,
        195,
        196,
        197,
        198,
        199,
        200,
        201,
        202,
        203,
        204,
        205,
        206,
        207,
        208
      ],
      "reward_overall": [
        0.45451289398280803,
        0.5574712643678161,
        0.5637755102040817,
        0.5502717391304348,
        0.6367924528301887,
        0.5434210526315789,
        0.5407608695652174,
        0.5376157407407407,
        0.5630252100840336,
        0.5636792452830188,
        0.5963114754098361,
        0.5552884615384616,
        0.5444162436548223,
        0.5227272727272727,
        0.5892857142857143,
        0.555045871559633,
        0.6063432835820896,
        0.558641975308642,
        0.6068652849740933,
        0.6312189054726368,
        0.6131756756756757,
        0.6043632075471698,
        0.6603658536585366,
        0.64453125,
        0.6676401869158879,
        0.6663135593220338,
        0.6557203389830508,
        0.6595622119815668,
        0.6132075471698113,
        0.6310240963855421,
        0.65311004784689,
        0.6638349514563107,
        0.6050531914893617,
        0.6534598214285714,
        0.6660447761194029,
        0.6477272727272727,
        0.6474514563106796,
        0.6700507614213198,
        0.6628440366972477,
        0.6705069124423964,
        0.6512345679012346,
        0.6864754098360656,
        0.6883187772925764,
        0.6782670454545454,
        0.7064977973568282,
        0.7255813953488373,
        0.6682242990654206,
        0.7411242603550295,
        0.7071917808219178,
        0.7330729166666666,
        0.6954545454545454,
        0.7190533980582524,
        0.7737831858407079,
        0.7408536585365854,
        0.7331730769230769,
        0.7388771186440678,
        0.7506720430107527,
        0.7401079136690647,
        0.7811135371179039,
        0.7492774566473989,
        0.7846715328467153,
        0.7557692307692307,
        0.8116438356164384,
        0.7777777777777778,
        0.815625,
        0.7725409836065574,
        0.8265810276679841,
        0.8065217391304348,
        0.8044554455445545,
        0.7550448430493274,
        0.8218201754385965,
        0.7883333333333333,
        0.8009478672985783,
        0.7606635071090048,
        0.8196078431372549,
        0.7968106995884774,
        0.806282722513089,
        0.8226872246696035,
        0.7787356321839081,
        0.8255434782608696,
        0.7913179916317992,
        0.8453125,
        0.8146367521367521,
        0.8327991452991453,
        0.8319288389513109,
        0.8001269035532995,
        0.8401639344262295,
        0.8188202247191011,
        0.8295807453416149,
        0.8353448275862069,
        0.8051675977653632,
        0.85,
        0.8384433962264151,
        0.8211805555555556,
        0.8633720930232558,
        0.8241525423728814,
        0.8526392961876833,
        0.8408119658119658,
        0.8229537366548043,
        0.8192640692640693,
        0.8528368794326241,
        0.8367962466487936,
        0.8450292397660819,
        0.8154965753424658,
        0.8273026315789473,
        0.8452898550724638,
        0.8467741935483871,
        0.8499410377358491,
        0.8588461538461538,
        0.856508875739645,
        0.8503039513677811,
        0.8356109324758842,
        0.8202054794520548,
        0.8647540983606558,
        0.8478084415584416,
        0.8566978193146417,
        0.8357740585774058,
        0.848015873015873,
        0.8543478260869565,
        0.8475,
        0.846958174904943,
        0.8471074380165289,
        0.8518683274021353,
        0.8496503496503497,
        0.8246951219512195,
        0.8558868501529052,
        0.8479508196721312,
        0.8500874125874126,
        0.8309608540925267,
        0.8524143302180686,
        0.8552852348993288,
        0.8558823529411764,
        0.8592105263157894,
        0.8347069597069597,
        0.8413461538461539,
        0.8584905660377359,
        0.8623919308357348,
        0.8657407407407407,
        0.8490497076023392,
        0.8652506963788301,
        0.8620689655172413,
        0.8557692307692307,
        0.8622448979591837,
        0.8656957928802589,
        0.8526357827476039,
        0.8277671755725191,
        0.8521551724137931,
        0.8730842911877394,
        0.8508196721311475,
        0.8506944444444444,
        0.864946380697051,
        0.858085808580858,
        0.8679653679653679,
        0.8325358851674641,
        0.8619477911646586,
        0.8579545454545454,
        0.8369771863117871,
        0.8621323529411765,
        0.8673469387755102,
        0.8729224376731302,
        0.8679178470254958,
        0.8657760814249363,
        0.8822418136020151,
        0.8720854922279793,
        0.8699460916442049,
        0.8809523809523809,
        0.8635245901639345,
        0.849250936329588,
        0.871919014084507,
        0.8758680555555556,
        0.8353544776119403,
        0.8603219696969697,
        0.8597756410256411,
        0.8746044303797469,
        0.849624060150376,
        0.8675249169435216,
        0.8685109289617486,
        0.8680098684210527,
        0.8799857549857549,
        0.8453846153846154,
        0.8725910064239829,
        0.8614783653846154,
        0.865847280334728,
        0.8825520833333333,
        0.8707943925233644,
        0.8700873362445415,
        0.8774774774774775,
        0.8826476793248945,
        0.8643497757847534,
        0.8733333333333333,
        0.877123786407767,
        0.8916666666666667,
        0.8724489795918368,
        0.8828347578347578,
        0.8613707165109035,
        0.8525985663082437,
        0.8820671378091873,
        0.8780581039755352,
        0.8200431034482759,
        0.868,
        0.8636363636363636,
        0.8454861111111112,
        0.87890625,
        0.7799657534246576,
        0.6099290780141844,
        0.6098726114649682,
        0.37896825396825395,
        0.09346330275229357
      ],
      "frac_all_correct": [
        0.07163323782234957,
        0.13793103448275862,
        0.16326530612244897,
        0.15217391304347827,
        0.19811320754716982,
        0.22105263157894736,
        0.2,
        0.1712962962962963,
        0.13445378151260504,
        0.07547169811320754,
        0.30327868852459017,
        0.23557692307692307,
        0.22842639593908629,
        0.07792207792207792,
        0.2857142857142857,
        0.2706422018348624,
        0.25870646766169153,
        0.2345679012345679,
        0.30569948186528495,
        0.29850746268656714,
        0.32882882882882886,
        0.2688679245283019,
        0.37073170731707317,
        0.3125,
        0.37850467289719625,
        0.3389830508474576,
        0.4576271186440678,
        0.3640552995391705,
        0.2830188679245283,
        0.3253012048192771,
        0.37320574162679426,
        0.3883495145631068,
        0.2765957446808511,
        0.4330357142857143,
        0.34328358208955223,
        0.41414141414141414,
        0.4077669902912621,
        0.40609137055837563,
        0.4036697247706422,
        0.423963133640553,
        0.4012345679012346,
        0.45901639344262296,
        0.4672489082969432,
        0.4659090909090909,
        0.5110132158590308,
        0.5348837209302325,
        0.43457943925233644,
        0.5325443786982249,
        0.547945205479452,
        0.5364583333333334,
        0.5272727272727272,
        0.5242718446601942,
        0.6238938053097345,
        0.5365853658536586,
        0.5432692307692307,
        0.5,
        0.5376344086021505,
        0.5539568345323741,
        0.6157205240174672,
        0.5664739884393064,
        0.6277372262773723,
        0.5307692307692308,
        0.6484018264840182,
        0.6342592592592593,
        0.6458333333333334,
        0.6284153005464481,
        0.6640316205533597,
        0.6347826086956522,
        0.6138613861386139,
        0.5739910313901345,
        0.6578947368421053,
        0.6133333333333333,
        0.6113744075829384,
        0.5545023696682464,
        0.6862745098039216,
        0.6625514403292181,
        0.6649214659685864,
        0.6784140969162996,
        0.5632183908045977,
        0.6826086956521739,
        0.6317991631799164,
        0.7166666666666667,
        0.6367521367521367,
        0.6837606837606838,
        0.704119850187266,
        0.6446700507614214,
        0.6926229508196722,
        0.6966292134831461,
        0.7298136645962733,
        0.7206896551724138,
        0.6815642458100558,
        0.7172413793103448,
        0.7358490566037735,
        0.7013888888888888,
        0.7881136950904393,
        0.6991525423728814,
        0.7712609970674487,
        0.7521367521367521,
        0.7117437722419929,
        0.70995670995671,
        0.7659574468085106,
        0.7613941018766756,
        0.7602339181286549,
        0.708904109589041,
        0.7236842105263158,
        0.7681159420289855,
        0.7692307692307693,
        0.7948113207547169,
        0.7784615384615384,
        0.7781065088757396,
        0.7598784194528876,
        0.729903536977492,
        0.7031963470319634,
        0.7704918032786885,
        0.7467532467532467,
        0.7570093457943925,
        0.7071129707112971,
        0.7555555555555555,
        0.7623188405797101,
        0.728,
        0.7414448669201521,
        0.7713498622589532,
        0.7437722419928826,
        0.7307692307692307,
        0.7235772357723578,
        0.7614678899082569,
        0.7311475409836066,
        0.7482517482517482,
        0.7544483985765125,
        0.7507788161993769,
        0.7550335570469798,
        0.7558823529411764,
        0.7736842105263158,
        0.717948717948718,
        0.7115384615384616,
        0.7641509433962265,
        0.7780979827089337,
        0.7692307692307693,
        0.7602339181286549,
        0.7966573816155988,
        0.786833855799373,
        0.7628205128205128,
        0.7551020408163265,
        0.7734627831715211,
        0.7348242811501597,
        0.7251908396946565,
        0.7655172413793103,
        0.7432950191570882,
        0.7737704918032787,
        0.7561728395061729,
        0.7908847184986595,
        0.7656765676567657,
        0.7229437229437229,
        0.7177033492822966,
        0.7188755020080321,
        0.7532467532467533,
        0.7452471482889734,
        0.7852941176470588,
        0.7687074829931972,
        0.7894736842105263,
        0.7875354107648725,
        0.7837150127226463,
        0.8060453400503779,
        0.7953367875647669,
        0.7897574123989218,
        0.7886904761904762,
        0.7540983606557377,
        0.7415730337078652,
        0.7570422535211268,
        0.7465277777777778,
        0.6791044776119403,
        0.7386363636363636,
        0.7211538461538461,
        0.7689873417721519,
        0.7593984962406015,
        0.7641196013289037,
        0.7950819672131147,
        0.7598684210526315,
        0.7834757834757835,
        0.7353846153846154,
        0.8201284796573876,
        0.7956730769230769,
        0.8096234309623431,
        0.83125,
        0.8280373831775701,
        0.8122270742358079,
        0.8306306306306306,
        0.8333333333333334,
        0.8004484304932735,
        0.8111111111111111,
        0.8106796116504854,
        0.8066666666666666,
        0.7517006802721088,
        0.7749287749287749,
        0.7632398753894081,
        0.7526881720430108,
        0.784452296819788,
        0.7737003058103975,
        0.6637931034482759,
        0.732,
        0.6985645933014354,
        0.6851851851851852,
        0.671875,
        0.5342465753424658,
        0.15602836879432624,
        0.14012738853503184,
        0.07936507936507936,
        0.009174311926605505
      ],
      "frac_all_wrong": [
        0.2148997134670487,
        0.10344827586206896,
        0.08163265306122448,
        0.06521739130434782,
        0.0660377358490566,
        0.15789473684210525,
        0.14782608695652175,
        0.1574074074074074,
        0.09243697478991597,
        0.03773584905660377,
        0.13934426229508196,
        0.1875,
        0.16243654822335024,
        0.1038961038961039,
        0.1978021978021978,
        0.1926605504587156,
        0.12437810945273632,
        0.16049382716049382,
        0.18652849740932642,
        0.13432835820895522,
        0.16666666666666666,
        0.15566037735849056,
        0.14146341463414633,
        0.15104166666666666,
        0.1588785046728972,
        0.17796610169491525,
        0.16101694915254236,
        0.17050691244239632,
        0.13836477987421383,
        0.10843373493975904,
        0.18181818181818182,
        0.1262135922330097,
        0.19148936170212766,
        0.17410714285714285,
        0.14925373134328357,
        0.15151515151515152,
        0.17475728155339806,
        0.14720812182741116,
        0.14678899082568808,
        0.16129032258064516,
        0.14814814814814814,
        0.12295081967213115,
        0.16593886462882096,
        0.1590909090909091,
        0.18061674008810572,
        0.17209302325581396,
        0.19626168224299065,
        0.1242603550295858,
        0.1643835616438356,
        0.14583333333333334,
        0.15757575757575756,
        0.16019417475728157,
        0.13716814159292035,
        0.14634146341463414,
        0.14903846153846154,
        0.13983050847457626,
        0.11290322580645161,
        0.1510791366906475,
        0.13973799126637554,
        0.1329479768786127,
        0.12043795620437957,
        0.14615384615384616,
        0.1141552511415525,
        0.1388888888888889,
        0.1125,
        0.14754098360655737,
        0.11462450592885376,
        0.12608695652173912,
        0.10396039603960396,
        0.14798206278026907,
        0.10526315789473684,
        0.09777777777777778,
        0.11374407582938388,
        0.13744075829383887,
        0.10588235294117647,
        0.12345679012345678,
        0.1099476439790576,
        0.1145374449339207,
        0.1206896551724138,
        0.10869565217391304,
        0.13389121338912133,
        0.09583333333333334,
        0.11965811965811966,
        0.09829059829059829,
        0.11235955056179775,
        0.12690355329949238,
        0.10245901639344263,
        0.11235955056179775,
        0.11801242236024845,
        0.10689655172413794,
        0.1340782122905028,
        0.09655172413793103,
        0.12264150943396226,
        0.11805555555555555,
        0.10594315245478036,
        0.1228813559322034,
        0.10263929618768329,
        0.11965811965811966,
        0.12811387900355872,
        0.12987012987012986,
        0.09219858156028368,
        0.128686327077748,
        0.1111111111111111,
        0.1267123287671233,
        0.10087719298245613,
        0.11014492753623188,
        0.11662531017369727,
        0.12028301886792453,
        0.10461538461538461,
        0.10355029585798817,
        0.1094224924012158,
        0.11254019292604502,
        0.1141552511415525,
        0.09508196721311475,
        0.11363636363636363,
        0.102803738317757,
        0.11715481171548117,
        0.10476190476190476,
        0.1072463768115942,
        0.104,
        0.11406844106463879,
        0.11294765840220386,
        0.09608540925266904,
        0.10839160839160839,
        0.12195121951219512,
        0.10703363914373089,
        0.09836065573770492,
        0.10839160839160839,
        0.12099644128113879,
        0.11214953271028037,
        0.1040268456375839,
        0.10588235294117647,
        0.11052631578947368,
        0.11355311355311355,
        0.1076923076923077,
        0.11006289308176101,
        0.10086455331412104,
        0.09971509971509972,
        0.10818713450292397,
        0.10584958217270195,
        0.10658307210031348,
        0.10576923076923077,
        0.09795918367346938,
        0.0970873786407767,
        0.10223642172523961,
        0.12213740458015267,
        0.10344827586206896,
        0.0842911877394636,
        0.1180327868852459,
        0.1111111111111111,
        0.10455764075067024,
        0.10561056105610561,
        0.09090909090909091,
        0.12440191387559808,
        0.08835341365461848,
        0.09415584415584416,
        0.12167300380228137,
        0.10588235294117647,
        0.09523809523809523,
        0.10249307479224377,
        0.09915014164305949,
        0.10432569974554708,
        0.0906801007556675,
        0.10103626943005181,
        0.09973045822102426,
        0.08333333333333333,
        0.09180327868852459,
        0.1198501872659176,
        0.08450704225352113,
        0.08333333333333333,
        0.11194029850746269,
        0.0946969696969697,
        0.08333333333333333,
        0.09177215189873418,
        0.11654135338345864,
        0.09634551495016612,
        0.10382513661202186,
        0.09210526315789473,
        0.09116809116809117,
        0.11384615384615385,
        0.10278372591006424,
        0.10096153846153846,
        0.100418410041841,
        0.09583333333333334,
        0.102803738317757,
        0.10262008733624454,
        0.0936936936936937,
        0.09282700421940929,
        0.1031390134529148,
        0.10222222222222223,
        0.09223300970873786,
        0.07333333333333333,
        0.08503401360544217,
        0.08547008547008547,
        0.08411214953271028,
        0.1039426523297491,
        0.07773851590106007,
        0.08256880733944955,
        0.10344827586206896,
        0.072,
        0.07655502392344497,
        0.09722222222222222,
        0.0625,
        0.0958904109589041,
        0.07092198581560284,
        0.09554140127388536,
        0.24338624338624337,
        0.7247706422018348
      ],
      "completion_len": [
        404.8125,
        400.0625,
        417.125,
        420.5,
        340.3125,
        304.6875,
        280.5625,
        391.125,
        440.3125,
        195.0625,
        252.1875,
        129.1875,
        166.0,
        176.625,
        209.375,
        243.75,
        293.8125,
        346.125,
        385.375,
        403.0625,
        501.1875,
        512.0,
        497.3125,
        478.625,
        498.625,
        493.1875,
        512.0,
        491.1875,
        512.0,
        512.0,
        512.0,
        512.0,
        498.3125,
        512.0,
        512.0,
        512.0,
        482.75,
        512.0,
        512.0,
        512.0,
        411.8125,
        455.125,
        347.25,
        207.4375,
        179.625,
        70.125,
        115.875,
        104.375,
        82.625,
        116.5,
        96.5,
        93.9375,
        81.125,
        65.8125,
        71.4375,
        140.8125,
        82.1875,
        110.0625,
        128.1875,
        300.3125,
        74.375,
        209.0625,
        298.25,
        68.5625,
        170.875,
        111.6875,
        184.0,
        180.875,
        63.5625,
        192.375,
        168.0625,
        195.6875,
        124.0,
        104.9375,
        132.9375,
        85.75,
        78.875,
        81.875,
        143.875,
        95.8125,
        193.875,
        49.25,
        152.375,
        167.9375,
        172.75,
        231.625,
        203.625,
        192.3125,
        134.875,
        107.4375,
        100.25,
        77.25,
        112.25,
        118.3125,
        52.125,
        83.625,
        111.25,
        74.9375,
        95.625,
        83.5,
        138.125,
        108.3125,
        44.4375,
        105.3125,
        91.3125,
        70.3125,
        138.625,
        91.8125,
        71.5625,
        85.5,
        88.4375,
        90.25,
        107.125,
        97.0625,
        82.625,
        87.25,
        116.3125,
        98.125,
        72.25,
        101.25,
        194.6875,
        111.0625,
        80.375,
        75.5625,
        129.125,
        64.25,
        71.3125,
        82.6875,
        105.0,
        100.8125,
        107.5625,
        69.25,
        50.5,
        60.75,
        96.4375,
        79.5625,
        105.3125,
        67.6875,
        125.875,
        65.1875,
        77.5625,
        155.125,
        72.25,
        74.0625,
        48.0625,
        88.4375,
        70.0625,
        55.1875,
        147.125,
        134.6875,
        135.875,
        51.25,
        60.0,
        60.0625,
        88.25,
        84.1875,
        69.1875,
        98.0625,
        92.6875,
        59.75,
        118.5,
        125.9375,
        70.125,
        75.75,
        142.3125,
        48.5625,
        50.75,
        126.875,
        56.125,
        50.4375,
        96.4375,
        124.6875,
        88.375,
        47.125,
        61.625,
        95.8125,
        75.3125,
        107.375,
        80.8125,
        151.375,
        110.375,
        129.125,
        59.75,
        114.6875,
        151.625,
        106.25,
        51.9375,
        91.625,
        142.9375,
        86.4375,
        115.0,
        187.625,
        122.5625,
        167.0625,
        98.125,
        67.625,
        184.125,
        52.3125,
        128.4375,
        143.375,
        100.9375,
        117.0625,
        239.6875,
        235.3125,
        127.0,
        104.8125,
        61.0,
        58.5
      ],
      "loss": [
        3.615184687077999e-05,
        2.8051435947418213e-05,
        0.0001769105438143015,
        0.00023217941634356976,
        0.0001636836677789688,
        0.0011084121651947498,
        0.0005386683624237776,
        0.00023407605476677418,
        0.0005372881423681974,
        0.0013466759119182825,
        0.001678456086665392,
        0.0008754837326705456,
        0.0010048884432762861,
        0.00036269822157919407,
        0.0007514064200222492,
        0.0007770946249365807,
        0.0007035338785499334,
        -4.822644405066967e-05,
        0.00011344254016876221,
        7.901294156908989e-05,
        0.000287842471152544,
        6.940541788935661e-05,
        9.298324584960938e-06,
        0.0001825366634875536,
        0.00016822665929794312,
        9.887944906949997e-05,
        0.0003030116204172373,
        4.676496610045433e-05,
        9.946548379957676e-05,
        0.00010684109292924404,
        0.00022167060524225235,
        0.00015623774379491806,
        0.00022835936397314072,
        7.301452569663525e-05,
        0.00011515012010931969,
        0.00013436656445264816,
        0.00022935448214411736,
        0.00020441901870071888,
        0.0006493912078440189,
        0.0002570741344243288,
        0.00023149955086410046,
        0.0006051985546946526,
        0.0005437335930764675,
        0.00036470149643719196,
        0.00021473783999681473,
        0.0006836478132754564,
        0.000687792431563139,
        0.0004364405758678913,
        0.0012491201050579548,
        0.0010367014911025763,
        0.0017073675990104675,
        0.0016526400577276945,
        0.0033529133070260286,
        0.0006782137788832188,
        0.0004923657979816198,
        0.0011724673677235842,
        0.0006220503710210323,
        0.0007745525799691677,
        7.663224823772907e-05,
        0.0011904288548976183,
        0.0009794395882636309,
        0.0012236584443598986,
        0.0017318527679890394,
        0.0012421337887644768,
        6.201211363077164e-06,
        0.0019698524847626686,
        0.0017022201791405678,
        0.000529230572283268,
        0.0006130130495876074,
        0.0026620959397405386,
        0.0003251815214753151,
        0.001859921496361494,
        0.0014259049203246832,
        0.0003901741001754999,
        0.0015873811207711697,
        0.0016852119006216526,
        0.002193193417042494,
        0.002059376798570156,
        0.0035687533672899008,
        0.001034824177622795,
        0.0020506558939814568,
        0.0019463826902210712,
        0.001394324703142047,
        0.0042237716261297464,
        0.0010854813735932112,
        0.002026998670771718,
        0.0018317971844226122,
        0.0025801174342632294,
        0.0030621590558439493,
        0.0036822061520069838,
        0.0021897717379033566,
        0.0023353483993560076,
        0.0018786648288369179,
        0.003235654439777136,
        0.003160189837217331,
        0.002208258956670761,
        0.0029184469021856785,
        0.001765567110851407,
        0.0018952954560518265,
        0.0016099815256893635,
        0.0033394128549844027,
        0.0028843351174145937,
        0.0018579610623419285,
        0.004376498516649008,
        0.0017983380239456892,
        0.0010052556172013283,
        0.0010596273932605982,
        0.0006032870151102543,
        0.002140405820682645,
        0.10132399876601994,
        0.0023025665432214737,
        0.0025368565693497658,
        0.0036209968384355307,
        0.001811726950109005,
        0.001486019929870963,
        0.0014985071029514074,
        0.002146432176232338,
        0.0032321910839527845,
        0.001665135845541954,
        0.0009683044627308846,
        0.000885325949639082,
        0.00191847188398242,
        0.0014833980239927769,
        0.0009807557798922062,
        0.000735047273337841,
        0.0009515932761132717,
        0.0008428613655269146,
        0.0003683939576148987,
        0.002238792832940817,
        0.0020576859824359417,
        0.001138248946517706,
        0.001761321909725666,
        0.0002426689025014639,
        0.0009227755945175886,
        0.007814430398866534,
        0.00018400652334094048,
        0.000764662167057395,
        0.001540319062769413,
        0.001974282320588827,
        0.011031767586246133,
        0.0009159306064248085,
        0.004131096648052335,
        0.0009727496653795242,
        0.0025513232685625553,
        0.0004725924227386713,
        0.005819528363645077,
        0.003589704865589738,
        0.0026164324954152107,
        0.0027795189525932074,
        0.002067729365080595,
        0.003170352429151535,
        0.002682384569197893,
        0.002471704501658678,
        0.0021758803632110357,
        0.0031201913952827454,
        0.0017175355460494757,
        0.0012087495997548103,
        0.0025682984851300716,
        0.002956812735646963,
        0.0017507837619632483,
        0.0012334282509982586,
        0.0019627301953732967,
        0.0019267224706709385,
        0.0024056280963122845,
        0.0028596753254532814,
        0.0006672786548733711,
        0.0020595930982381105,
        0.004130132496356964,
        0.0020661004818975925,
        0.002461035270243883,
        0.0011915769428014755,
        0.0006822114810347557,
        0.00554751418530941,
        0.005950157064944506,
        0.022075418615713716,
        0.0017355596646666527,
        0.0010665967129170895,
        0.004028844181448221,
        0.0033693453297019005,
        0.0013583479449152946,
        0.0015053704846650362,
        0.0032343226484954357,
        0.0011504292488098145,
        0.0019438283052295446,
        0.0014391138684004545,
        0.001230505295097828,
        0.002978096017614007,
        0.0013340176083147526,
        0.0022158073261380196,
        0.0023927197325974703,
        0.002654936397448182,
        0.0030677588656544685,
        0.0013212747871875763,
        -6.929133087396622e-05,
        0.010685474146157503,
        0.0028205779381096363,
        0.0023424343671649694,
        1.0679532189387828,
        0.0018731323070824146,
        0.005430935183539987,
        0.0012322179973125458,
        0.002496538683772087,
        0.0008534411899745464,
        0.002557869767770171,
        0.002511409344151616,
        0.002067920286208391,
        0.0008540414273738861,
        0.0018478317651897669
      ],
      "loss_grpo": [
        3.615184687077999e-05,
        2.8051435947418213e-05,
        0.0001769105438143015,
        0.00023217941634356976,
        0.0001636836677789688,
        0.0011084121651947498,
        0.0005386683624237776,
        0.00023407605476677418,
        0.0005372881423681974,
        0.0013466759119182825,
        0.001678456086665392,
        0.0008754837326705456,
        0.0010048884432762861,
        0.00036269822157919407,
        0.0007514064200222492,
        0.0007770946249365807,
        0.0007035338785499334,
        -4.822644405066967e-05,
        0.00011344254016876221,
        7.901294156908989e-05,
        0.000287842471152544,
        6.940541788935661e-05,
        9.298324584960938e-06,
        0.0001825366634875536,
        0.00016822665929794312,
        9.887944906949997e-05,
        0.0003030116204172373,
        4.676496610045433e-05,
        9.946548379957676e-05,
        0.00010684109292924404,
        0.00022167060524225235,
        0.00015623774379491806,
        0.00022835936397314072,
        7.301452569663525e-05,
        0.00011515012010931969,
        0.00013436656445264816,
        0.00022935448214411736,
        0.00020441901870071888,
        0.0006493912078440189,
        0.0002570741344243288,
        0.00023149955086410046,
        0.0006051985546946526,
        0.0005437335930764675,
        0.00036470149643719196,
        0.00021473783999681473,
        0.0006836478132754564,
        0.000687792431563139,
        0.0004364405758678913,
        0.0012491201050579548,
        0.0010367014911025763,
        0.0017073675990104675,
        0.0016526400577276945,
        0.0033529133070260286,
        0.0006782137788832188,
        0.0004923657979816198,
        0.0011724673677235842,
        0.0006220503710210323,
        0.0007745525799691677,
        7.663224823772907e-05,
        0.0011904288548976183,
        0.0009794395882636309,
        0.0012236584443598986,
        0.0017318527679890394,
        0.0012421337887644768,
        6.201211363077164e-06,
        0.0019698524847626686,
        0.0017022201791405678,
        0.000529230572283268,
        0.0006130130495876074,
        0.0026620959397405386,
        0.0003251815214753151,
        0.001859921496361494,
        0.0014259049203246832,
        0.0003901741001754999,
        0.0015873811207711697,
        0.0016852119006216526,
        0.002193193417042494,
        0.002059376798570156,
        0.0035687533672899008,
        0.001034824177622795,
        0.0020506558939814568,
        0.0019463826902210712,
        0.001394324703142047,
        0.0042237716261297464,
        0.0010854813735932112,
        0.002026998670771718,
        0.0018317971844226122,
        0.0025801174342632294,
        0.0030621590558439493,
        0.0036822061520069838,
        0.0021897717379033566,
        0.0023353483993560076,
        0.0018786648288369179,
        0.003235654439777136,
        0.003160189837217331,
        0.002208258956670761,
        0.0029184469021856785,
        0.001765567110851407,
        0.0018952954560518265,
        0.0016099815256893635,
        0.0033394128549844027,
        0.0028843351174145937,
        0.0018579610623419285,
        0.004376498516649008,
        0.0017983380239456892,
        0.0010052556172013283,
        0.0010596273932605982,
        0.0006032870151102543,
        0.002140405820682645,
        0.10132399876601994,
        0.0023025665432214737,
        0.0025368565693497658,
        0.0036209968384355307,
        0.001811726950109005,
        0.001486019929870963,
        0.0014985071029514074,
        0.002146432176232338,
        0.0032321910839527845,
        0.001665135845541954,
        0.0009683044627308846,
        0.000885325949639082,
        0.00191847188398242,
        0.0014833980239927769,
        0.0009807557798922062,
        0.000735047273337841,
        0.0009515932761132717,
        0.0008428613655269146,
        0.0003683939576148987,
        0.002238792832940817,
        0.0020576859824359417,
        0.001138248946517706,
        0.001761321909725666,
        0.0002426689025014639,
        0.0009227755945175886,
        0.007814430398866534,
        0.00018400652334094048,
        0.000764662167057395,
        0.001540319062769413,
        0.001974282320588827,
        0.011031767586246133,
        0.0009159306064248085,
        0.004131096648052335,
        0.0009727496653795242,
        0.0025513232685625553,
        0.0004725924227386713,
        0.005819528363645077,
        0.003589704865589738,
        0.0026164324954152107,
        0.0027795189525932074,
        0.002067729365080595,
        0.003170352429151535,
        0.002682384569197893,
        0.002471704501658678,
        0.0021758803632110357,
        0.0031201913952827454,
        0.0017175355460494757,
        0.0012087495997548103,
        0.0025682984851300716,
        0.002956812735646963,
        0.0017507837619632483,
        0.0012334282509982586,
        0.0019627301953732967,
        0.0019267224706709385,
        0.0024056280963122845,
        0.0028596753254532814,
        0.0006672786548733711,
        0.0020595930982381105,
        0.004130132496356964,
        0.0020661004818975925,
        0.002461035270243883,
        0.0011915769428014755,
        0.0006822114810347557,
        0.00554751418530941,
        0.005950157064944506,
        0.022075418615713716,
        0.0017355596646666527,
        0.0010665967129170895,
        0.004028844181448221,
        0.0033693453297019005,
        0.0013583479449152946,
        0.0015053704846650362,
        0.0032343226484954357,
        0.0011504292488098145,
        0.0019438283052295446,
        0.0014391138684004545,
        0.001230505295097828,
        0.002978096017614007,
        0.0013340176083147526,
        0.0022158073261380196,
        0.0023927197325974703,
        0.002654936397448182,
        0.0030677588656544685,
        0.0013212747871875763,
        -6.929133087396622e-05,
        0.010685474146157503,
        0.0028205779381096363,
        0.0023424343671649694,
        1.0679532189387828,
        0.0018731323070824146,
        0.005430935183539987,
        0.0012322179973125458,
        0.002496538683772087,
        0.0008534411899745464,
        0.002557869767770171,
        0.002511409344151616,
        0.002067920286208391,
        0.0008540414273738861,
        0.0018478317651897669
      ],
      "loss_sft": [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      "kl_mean": [
        9.485903319728095e-06,
        0.006319160107523203,
        0.015649566426873207,
        0.019729387015104294,
        0.022877532988786697,
        0.02289040945470333,
        0.03198320418596268,
        0.03320758417248726,
        0.023874647915363312,
        0.06566964834928513,
        0.06749026477336884,
        0.11612127721309662,
        0.11416850984096527,
        0.09952173382043839,
        0.0802718922495842,
        0.07779738306999207,
        0.06127513572573662,
        0.05605068802833557,
        0.04508941248059273,
        0.05325517803430557,
        0.04552203416824341,
        0.04184981808066368,
        0.0426444374024868,
        0.050715941935777664,
        0.04554801806807518,
        0.047486379742622375,
        0.04861295595765114,
        0.04804765060544014,
        0.04996492341160774,
        0.0507919117808342,
        0.04385942965745926,
        0.04226163774728775,
        0.05699591711163521,
        0.04395047202706337,
        0.044512514024972916,
        0.04609591141343117,
        0.04341574013233185,
        0.05173845589160919,
        0.05045595020055771,
        0.046251893043518066,
        0.05392562225461006,
        0.04576468840241432,
        0.05622530356049538,
        0.11348333209753036,
        0.07688666880130768,
        0.1656561642885208,
        0.12241626530885696,
        0.13071280717849731,
        0.19924932718276978,
        0.1320406198501587,
        0.15106891095638275,
        0.1640719324350357,
        0.709011435508728,
        0.1875867247581482,
        0.18694216012954712,
        0.16655918955802917,
        0.20585668087005615,
        0.21633905172348022,
        0.1447458118200302,
        0.0681229829788208,
        0.20710112154483795,
        0.11929162591695786,
        0.0646698921918869,
        0.2667979896068573,
        0.11480752378702164,
        0.16079077124595642,
        0.12428051978349686,
        0.1193007081747055,
        0.24895058572292328,
        0.08739877492189407,
        0.15206001698970795,
        0.13078925013542175,
        0.17883814871311188,
        0.20124299824237823,
        0.2297823429107666,
        0.19359257817268372,
        0.192661851644516,
        0.2062990516424179,
        0.13098078966140747,
        0.19096499681472778,
        0.10902636498212814,
        0.3722759485244751,
        0.1427079737186432,
        0.20888036489486694,
        0.1429872214794159,
        0.11238742619752884,
        0.1322648674249649,
        0.1723487824201584,
        0.1685141921043396,
        0.18752038478851318,
        0.16991612315177917,
        0.21325623989105225,
        0.19214412569999695,
        0.16278450191020966,
        0.2737200856208801,
        0.2192217856645584,
        0.14259959757328033,
        0.23935161530971527,
        0.19541604816913605,
        0.16895195841789246,
        0.15010325610637665,
        0.17847858369350433,
        0.36387521028518677,
        0.16802245378494263,
        0.20884229242801666,
        0.27983570098876953,
        0.11889372766017914,
        0.1898113191127777,
        0.542547345161438,
        0.21057768166065216,
        0.24451960623264313,
        0.19641532003879547,
        0.15685099363327026,
        0.282627135515213,
        0.20684273540973663,
        0.2561924159526825,
        0.19398120045661926,
        0.4011174738407135,
        1.5293300151824951,
        0.20969009399414062,
        0.1229059249162674,
        0.17840208113193512,
        0.23963680863380432,
        0.23246759176254272,
        0.21225088834762573,
        0.34739938378334045,
        0.2754787504673004,
        0.21703776717185974,
        0.17110615968704224,
        0.2328500896692276,
        0.2277078926563263,
        0.32905271649360657,
        0.3415141999721527,
        0.3120279908180237,
        0.18327870965003967,
        0.2489977478981018,
        0.39131924510002136,
        0.3343675136566162,
        0.19878490269184113,
        0.3341137170791626,
        0.22829125821590424,
        0.3643859624862671,
        0.30884307622909546,
        0.26696762442588806,
        0.4327143132686615,
        0.23747998476028442,
        0.3022429049015045,
        0.39764735102653503,
        0.16748428344726562,
        0.182583749294281,
        0.207363560795784,
        0.3930317163467407,
        0.2724165916442871,
        0.4879510998725891,
        0.2823742628097534,
        0.27100539207458496,
        0.2586217224597931,
        0.2322997748851776,
        0.2564529776573181,
        0.39188656210899353,
        0.25981080532073975,
        0.2558731138706207,
        0.27654537558555603,
        0.25384241342544556,
        0.14101113379001617,
        0.6703770756721497,
        0.43398433923721313,
        0.1926681399345398,
        0.5834731459617615,
        0.40313535928726196,
        0.2335253804922104,
        0.17561163008213043,
        43.01306915283203,
        0.6316280961036682,
        0.4630269706249237,
        0.31380367279052734,
        0.3389451801776886,
        0.34364694356918335,
        0.3918100595474243,
        0.2202577292919159,
        0.3087098300457001,
        0.27298250794410706,
        0.5730693340301514,
        0.34672674536705017,
        0.25749698281288147,
        0.29710686206817627,
        0.5450629591941833,
        0.3912186920642853,
        0.26811620593070984,
        0.3715425133705139,
        0.2312311828136444,
        0.1437285989522934,
        0.2624955177307129,
        0.17347635328769684,
        0.300432950258255,
        0.392941415309906,
        0.14557552337646484,
        0.4298288822174072,
        0.2213471680879593,
        0.18727989494800568,
        0.2537398040294647,
        0.48667919635772705,
        0.16051456332206726,
        0.12257558852434158,
        0.2182055413722992,
        0.29496467113494873,
        0.480702668428421,
        0.39389729499816895
      ],
      "entropy_mean": [
        0.3310718238353729,
        0.5024238228797913,
        0.41023191809654236,
        0.40749192237854004,
        0.39191144704818726,
        0.33246469497680664,
        0.33127662539482117,
        0.28275853395462036,
        0.26092687249183655,
        0.3805585205554962,
        0.33232545852661133,
        0.41967904567718506,
        0.338116854429245,
        0.33425599336624146,
        0.28842923045158386,
        0.3233441710472107,
        0.2072792947292328,
        0.18217378854751587,
        0.1453220248222351,
        0.10985730588436127,
        0.08399870246648788,
        0.06578589975833893,
        0.0699189230799675,
        0.0701986700296402,
        0.05548957362771034,
        0.06115049868822098,
        0.049091681838035583,
        0.055318161845207214,
        0.05344831943511963,
        0.06159839779138565,
        0.047128718346357346,
        0.035840753465890884,
        0.0386817567050457,
        0.04164479300379753,
        0.036197729408741,
        0.03884859383106232,
        0.03667525574564934,
        0.051033370196819305,
        0.08611054718494415,
        0.05392774939537048,
        0.048548728227615356,
        0.06560223549604416,
        0.04858507215976715,
        0.07435498386621475,
        0.06441650539636612,
        0.1694072186946869,
        0.15863220393657684,
        0.07292503863573074,
        0.12293647229671478,
        0.11121337115764618,
        0.10501222312450409,
        0.12239627540111542,
        0.12792882323265076,
        0.09340551495552063,
        0.13434891402721405,
        0.15887859463691711,
        0.11955495923757553,
        0.12713702023029327,
        0.07813803106546402,
        0.05199682340025902,
        0.08267025649547577,
        0.08644038438796997,
        0.05628829449415207,
        0.1001581996679306,
        0.13061927258968353,
        0.11542770266532898,
        0.12871170043945312,
        0.07018578052520752,
        0.07666222751140594,
        0.04695161059498787,
        0.08508878201246262,
        0.12454032897949219,
        0.11257392913103104,
        0.09159956872463226,
        0.09418629109859467,
        0.09896980971097946,
        0.08252950012683868,
        0.10368754714727402,
        0.06458649039268494,
        0.10510939359664917,
        0.08315050601959229,
        0.07680104672908783,
        0.12637779116630554,
        0.11103731393814087,
        0.12889572978019714,
        0.12316016107797623,
        0.11913330852985382,
        0.14219486713409424,
        0.13449960947036743,
        0.1247028261423111,
        0.05670296773314476,
        0.07371217757463455,
        0.1168932318687439,
        0.0672801285982132,
        0.04664023965597153,
        0.03482284024357796,
        0.04773158207535744,
        0.04853123053908348,
        0.07609762251377106,
        0.05486135557293892,
        0.09035589545965195,
        0.05837354063987732,
        0.06030061095952988,
        0.08333426713943481,
        0.06018770858645439,
        0.08062344044446945,
        0.03609015420079231,
        0.05361013486981392,
        0.06698528677225113,
        0.06545183807611465,
        0.066465824842453,
        0.06150444969534874,
        0.04355326667428017,
        0.07943010330200195,
        0.056975770741701126,
        0.05850238725543022,
        0.0860285684466362,
        0.09044638276100159,
        0.0538364015519619,
        0.04875543713569641,
        0.09030276536941528,
        0.060815319418907166,
        0.06671368330717087,
        0.09235922247171402,
        0.10210008174180984,
        0.09124840050935745,
        0.05811329558491707,
        0.07280665636062622,
        0.05547526478767395,
        0.06526627391576767,
        0.062078993767499924,
        0.07212170213460922,
        0.0613354854285717,
        0.08308948576450348,
        0.07820480316877365,
        0.06288627535104752,
        0.10586626827716827,
        0.09253031015396118,
        0.07040426880121231,
        0.06528889387845993,
        0.05209561809897423,
        0.04157130792737007,
        0.08591700345277786,
        0.06997653841972351,
        0.08315348625183105,
        0.08779232203960419,
        0.09691072255373001,
        0.06715275347232819,
        0.06191849708557129,
        0.06978768855333328,
        0.0672723725438118,
        0.09205340594053268,
        0.08309448510408401,
        0.11260201781988144,
        0.13885840773582458,
        0.11139264702796936,
        0.08758465945720673,
        0.060509152710437775,
        0.08569038659334183,
        0.07959116250276566,
        0.09868346899747849,
        0.08134814351797104,
        0.07757081836462021,
        0.07647823542356491,
        0.06303044408559799,
        0.09664406627416611,
        0.15406827628612518,
        0.07185858488082886,
        0.08614937961101532,
        0.12431765347719193,
        0.06371793895959854,
        0.059515710920095444,
        0.07772070169448853,
        0.06108032539486885,
        0.04820212349295616,
        0.08167783915996552,
        0.049925822764635086,
        0.14134863018989563,
        0.03612504154443741,
        0.05964615195989609,
        0.0943988785147667,
        0.07140690833330154,
        0.1332000195980072,
        0.06009270250797272,
        0.06565022468566895,
        0.052420057356357574,
        0.1132635548710823,
        0.05894556641578674,
        0.04272046685218811,
        0.04268423095345497,
        0.0570472851395607,
        0.07235071063041687,
        0.20238681137561798,
        0.062453050166368484,
        0.09132354706525803,
        0.09993782639503479,
        0.06573434919118881,
        0.09537827223539352,
        0.10804255306720734,
        0.05891282483935356,
        0.10156528651714325,
        0.18390649557113647,
        0.1289318948984146,
        0.0975567176938057,
        0.08056212961673737,
        0.09412121027708054,
        0.07986737042665482,
        0.10865245759487152
      ],
      "eval_humaneval_steps": [
        20,
        40,
        60,
        80,
        100,
        120,
        140,
        160,
        180,
        200
      ],
      "eval_humaneval_accuracy": [
        0.47560975609756095,
        0.4451219512195122,
        0.4695121951219512,
        0.5426829268292683,
        0.5,
        0.45121951219512196,
        0.40853658536585363,
        0.4024390243902439,
        0.3719512195121951,
        0.3170731707317073
      ],
      "eval_mbpp_steps": [
        20,
        40,
        60,
        80,
        100,
        120,
        140,
        160,
        180,
        200
      ],
      "eval_mbpp_accuracy": [
        0.7165775401069518,
        0.732620320855615,
        0.8235294117647058,
        0.8556149732620321,
        0.8636363636363636,
        0.8716577540106952,
        0.8877005347593583,
        0.8983957219251337,
        0.8903743315508021,
        0.9010695187165776
      ],
      "eval_mbpp_test_steps": [
        20,
        40,
        60,
        80,
        100,
        120,
        140,
        160,
        180,
        200
      ],
      "eval_mbpp_test_accuracy": [
        0.7165775401069518,
        0.732620320855615,
        0.8235294117647058,
        0.8556149732620321,
        0.8636363636363636,
        0.8716577540106952,
        0.8877005347593583,
        0.8983957219251337,
        0.8903743315508021,
        0.9010695187165776
      ]
    }
  ],
  "summaries": {
    "original": {
      "id": "original",
      "final_reward": 0.6938259109311741,
      "final_loss": 0.0008925809524953365,
      "final_kl": 0.49553534388542175,
      "final_entropy": 1.9763915538787842,
      "final_completion_len": 128.8125,
      "final_frac_all_correct": 0.15789473684210525,
      "final_frac_all_wrong": 0.06882591093117409,
      "avg_reward": 0.678246913569599,
      "avg_loss": 0.0012164894491434098,
      "avg_completion_len": 160.5125,
      "total_steps": 140,
      "median_mfu": 54.7481067276893,
      "total_training_time": null,
      "avg_mean_lag": null,
      "total_filtered": 0,
      "total_wasted": 0,
      "median_time_per_step": 23.519310517000008,
      "label": "Standard verifier",
      "color": "#3b82f6",
      "benchmarks": {}
    },
    "truncated": {
      "id": "truncated",
      "final_reward": 0.09346330275229357,
      "final_loss": 0.0018478317651897669,
      "final_kl": 0.39389729499816895,
      "final_entropy": 0.10865245759487152,
      "final_completion_len": 58.5,
      "final_frac_all_correct": 0.009174311926605505,
      "final_frac_all_wrong": 0.7247706422018348,
      "avg_reward": 0.6748270827820108,
      "avg_loss": 0.002172533795237541,
      "avg_completion_len": 131.6125,
      "total_steps": 208,
      "median_mfu": 38.31826652381527,
      "total_training_time": null,
      "avg_mean_lag": null,
      "total_filtered": 0,
      "total_wasted": 0,
      "median_time_per_step": 34.11915864899993,
      "label": "Truncated verifier",
      "color": "#f97316",
      "benchmarks": {
        "humaneval": {
          "accuracy": 0.3170731707317073,
          "step": 200
        },
        "mbpp": {
          "accuracy": 0.9010695187165776,
          "step": 200
        },
        "mbpp_test": {
          "accuracy": 0.9010695187165776,
          "step": 200
        }
      }
    }
  }
};
const codePresets = [
  {
    "id": "both",
    "label": "Both runs",
    "runs": [
      "original",
      "truncated"
    ],
    "text": "Standard vs truncated verifier. Truncation clips model output at second top-level def/class before running tests."
  }
];

// Format specifications for different metric types
const codeFormats = {
    'final_reward': { format: '.3f', suffix: '' },
    'avg_reward': { format: '.3f', suffix: '' },
    'final_loss': { format: '.4f', suffix: '' },
    'avg_loss': { format: '.4f', suffix: '' },
    'final_kl': { format: '.2e', suffix: '' },
    'final_entropy': { format: '.3f', suffix: '' },
    'final_completion_len': { format: '.0f', suffix: ' tokens' },
    'avg_completion_len': { format: '.0f', suffix: ' tokens' },
    'final_frac_all_correct': { format: '.1%', suffix: '' },
    'final_frac_all_wrong': { format: '.1%', suffix: '' },
    'total_steps': { format: 'd', suffix: '' },
    'median_mfu': { format: '.1f', suffix: '%' },
    'total_training_time': { format: '.0f', suffix: 's' },
    'avg_mean_lag': { format: '.2f', suffix: '' },
    'avg_lag_0': { format: '.1f', suffix: '' },
    'avg_lag_1': { format: '.1f', suffix: '' },
    'avg_lag_2': { format: '.1f', suffix: '' },
    'total_filtered': { format: ',d', suffix: '' },
    'total_wasted': { format: ',d', suffix: '' },
    'median_time_per_step': { format: '.1f', suffix: 's' },
    'eval_accuracy': { format: '.1%', suffix: '' },
};

// Populate inline metric spans for this section
function codePopulateMetrics() {
    const spans = document.querySelectorAll('span.metric[data-run][data-key]');
    spans.forEach(span => {
        const runId = span.dataset.run;
        const key = span.dataset.key;
        const summary = codeData.summaries[runId];
        if (!summary) return;  // not our section
        const value = summary[key];
        if (value === null || value === undefined) {
            span.textContent = 'N/A';
            return;
        }
        const fmt = codeFormats[key] || { format: '.3f', suffix: '' };
        span.textContent = d3.format(fmt.format)(value) + fmt.suffix;
        if (summary.color) {
            span.style.color = summary.color;
            span.style.fontWeight = '600';
        }
    });
}

// Generate comparison table
function codeGenerateTable() {
    const container = document.getElementById('code-comparison-table');
    if (!container) return;

    const runs = codeData.runs;
    const summaries = codeData.summaries;
    const baseModel = codeData.base_model || null;

    const benchSet = new Set();
    const excludePrefixes = codeData.exclude_benchmarks || [];
    const shouldExclude = (b) => excludePrefixes.some(p => b === p || b.startsWith(p + ' '));
    runs.forEach(run => {
        const s = summaries[run.id];
        if (s && s.benchmarks) Object.keys(s.benchmarks).forEach(b => { if (!shouldExclude(b)) benchSet.add(b); });
    });
    if (baseModel) Object.keys(baseModel.benchmarks).forEach(b => { if (!shouldExclude(b)) benchSet.add(b); });
    const benchmarks = Array.from(benchSet).sort();
    if (benchmarks.length === 0) return;

    let html = '<table class="results-table comparison-table">';
    html += '<thead><tr><th>Benchmark (step 200)</th>';
    if (baseModel) html += `<th style="color:#999">${baseModel.label}</th>`;
    runs.forEach(run => {
        html += `<th data-run-id="${run.id}" style="color: ${run.color}">${run.label}</th>`;
    });
    html += '</tr></thead><tbody>';

    benchmarks.forEach(bench => {
        html += `<tr><td>${bench.toUpperCase()}</td>`;
        if (baseModel) {
            const bv = baseModel.benchmarks[bench];
            html += bv !== undefined && bv !== null
                ? `<td>${d3.format('.1%')(bv)}</td>`
                : '<td>&mdash;</td>';
        }
        runs.forEach(run => {
            const s = summaries[run.id];
            const bdata = s && s.benchmarks && s.benchmarks[bench];
            if (bdata && bdata.accuracy !== null && bdata.accuracy !== undefined) {
                html += `<td data-run-id="${run.id}">${d3.format('.1%')(bdata.accuracy)}</td>`;
            } else {
                html += `<td data-run-id="${run.id}">&mdash;</td>`;
            }
        });
        html += '</tr>';
    });

    html += '</tbody></table>';
    container.innerHTML = html;
}

// Shared tooltip (one per page)
if (typeof window._plotTooltip === 'undefined') {
    window._plotTooltip = null;
}
function codeGetTooltip() {
    if (!window._plotTooltip) {
        window._plotTooltip = d3.select('body').append('div')
            .attr('class', 'plot-tooltip')
            .style('position', 'absolute')
            .style('background', 'rgba(0,0,0,0.85)')
            .style('color', '#fff')
            .style('padding', '8px 12px')
            .style('border-radius', '4px')
            .style('font-size', '12px')
            .style('font-family', 'Source Code Pro, monospace')
            .style('pointer-events', 'none')
            .style('opacity', 0)
            .style('z-index', 1000)
            .style('white-space', 'nowrap');
    }
    return window._plotTooltip;
}

// --- Preset & checkbox UI ---

const codeVisible = new Set(codeData.runs.map(r => r.id));

function codeBuildPresets() {
    const container = document.getElementById('code-preset-buttons');
    if (!container || codePresets.length === 0) return;

    codePresets.forEach((preset, idx) => {
        const btn = document.createElement('button');
        btn.textContent = preset.label;
        btn.dataset.presetId = preset.id;
        if (idx === 0) btn.classList.add('active');
        btn.addEventListener('click', () => codeActivatePreset(preset.id));
        container.appendChild(btn);
    });

    // "Clear all" button
    const clearBtn = document.createElement('button');
    clearBtn.textContent = 'Clear all';
    clearBtn.addEventListener('click', () => {
        document.querySelectorAll('#code-preset-buttons button').forEach(b => b.classList.remove('active'));
        clearBtn.classList.add('active');
        codeVisible.clear();
        document.querySelectorAll('#code-run-legend label').forEach(label => {
            const cb = label.querySelector('input');
            cb.checked = false;
            label.classList.add('unchecked');
        });
        const explEl = document.getElementById('code-preset-explanation');
        if (explEl) explEl.textContent = '';
        codeRedraw();
    });
    container.appendChild(clearBtn);
}

function codeBuildLegend() {
    const container = document.getElementById('code-run-legend');
    if (!container) return;

    codeData.runs.forEach(run => {
        const label = document.createElement('label');
        label.dataset.runId = run.id;

        const cb = document.createElement('input');
        cb.type = 'checkbox';
        cb.checked = true;
        cb.dataset.runId = run.id;
        cb.addEventListener('change', () => {
            if (cb.checked) {
                codeVisible.add(run.id);
                label.classList.remove('unchecked');
            } else {
                codeVisible.delete(run.id);
                label.classList.add('unchecked');
            }
            document.querySelectorAll('#code-preset-buttons button').forEach(b => b.classList.remove('active'));
            codeRedraw();
        });

        const swatch = document.createElement('span');
        swatch.className = 'legend-swatch';
        swatch.style.background = run.color;

        const text = document.createTextNode(run.label);

        label.appendChild(cb);
        label.appendChild(swatch);
        label.appendChild(text);
        container.appendChild(label);
    });
}

function codeActivatePreset(presetId) {
    const preset = codePresets.find(p => p.id === presetId);
    if (!preset) return;

    document.querySelectorAll('#code-preset-buttons button').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.presetId === presetId);
    });

    codeVisible.clear();
    preset.runs.forEach(id => codeVisible.add(id));

    document.querySelectorAll('#code-run-legend label').forEach(label => {
        const cb = label.querySelector('input');
        const isVisible = codeVisible.has(cb.dataset.runId);
        cb.checked = isVisible;
        label.classList.toggle('unchecked', !isVisible);
    });

    const explEl = document.getElementById('code-preset-explanation');
    if (explEl) explEl.textContent = preset.text || '';

    codeRedraw();
}

// --- Plot configs ---

const codePlotConfigs = [
    { id: 'code-plot-reward', title: 'Reward', yKey: 'reward_overall', format: '.3f' },
    { id: 'code-plot-completion-len', title: 'Completion Length', yKey: 'completion_len', format: '.0f' },
    { id: 'code-plot-allcorr', title: 'Frac All Correct', yKey: 'frac_all_correct', format: '.1%' },
    { id: 'code-plot-allwrong', title: 'Frac All Wrong', yKey: 'frac_all_wrong', format: '.1%' },
    { id: 'code-plot-loss-grpo', title: 'GRPO Loss', yKey: 'loss_grpo', format: '.4f' },
    { id: 'code-plot-loss-sft', title: 'SFT Loss', yKey: 'loss_sft', format: '.4f' },
    { id: 'code-plot-kl', title: 'KL Divergence', yKey: 'kl_mean', format: '.4f' },
    { id: 'code-plot-entropy', title: 'Entropy', yKey: 'entropy_mean', format: '.3f' },
    { id: 'code-plot-eval-gsm8k', title: 'GSM8K Accuracy', stepsKey: 'eval_gsm8k_steps',
       yKey: 'eval_gsm8k_accuracy', format: '.1%', linear: true },
    { id: 'code-plot-eval-math', title: 'MATH Accuracy', stepsKey: 'eval_math_steps',
       yKey: 'eval_math_accuracy', format: '.1%', linear: true },
    { id: 'code-plot-eval-ifeval', title: 'IFEval Accuracy', stepsKey: 'eval_ifeval_steps',
       yKey: 'eval_ifeval_accuracy', format: '.1%', linear: true },
    { id: 'code-plot-eval-ifbench_test', title: 'IFBench Accuracy', stepsKey: 'eval_ifbench_test_steps',
       yKey: 'eval_ifbench_test_accuracy', format: '.1%', linear: true },
];

const codePassKConfigs = [];

function codeUpdateTableHighlight() {
    const table = document.querySelector('#code-comparison-table table');
    if (!table) return;
    table.querySelectorAll('[data-run-id]').forEach(cell => {
        cell.classList.toggle('col-selected', codeVisible.has(cell.dataset.runId));
        cell.classList.toggle('col-dimmed', !codeVisible.has(cell.dataset.runId));
    });
}

function codeRedraw() {
    codePlotConfigs.forEach(config => {
        const container = document.getElementById(config.id);
        if (!container) return;
        codeDrawPlot(container, codeData.runs, config, codeVisible);
    });
    codePassKConfigs.forEach(config => {
        const container = document.getElementById(config.id);
        if (!container) return;
        codeDrawPassKPlot(container, codeData.runs, config, codeVisible);
    });
    codeUpdateTableHighlight();
}

function codeDrawPlot(container, runs, config, highlightedSet) {
    container.innerHTML = '';

    const margin = { top: 16, right: 12, bottom: 28, left: 44 };
    const width = 336 - margin.left - margin.right;
    const height = 192 - margin.top - margin.bottom;

    const svg = d3.select(container)
        .append('svg')
        .attr('viewBox', `0 0 ${width + margin.left + margin.right} ${height + margin.top + margin.bottom}`)
        .attr('preserveAspectRatio', 'xMidYMid meet');

    const g = svg.append('g')
        .attr('transform', `translate(${margin.left},${margin.top})`);

    const stepsKey = config.stepsKey || 'steps';

    let baseAnchor = null;
    if (config.stepsKey && codeData.base_model) {
        const benchName = config.stepsKey.replace('eval_', '').replace('_steps', '');
        const baseAcc = codeData.base_model.benchmarks[benchName];
        if (baseAcc !== undefined) baseAnchor = baseAcc;
    }

    // Compute scales from ALL runs (not just highlighted)
    let allX = [];
    let allY = [];

    runs.forEach(run => {
        const xArr = run[stepsKey];
        if (!xArr || xArr.length === 0) return;
        if (baseAnchor !== null) { allX.push(0); allY.push(baseAnchor); }
        allX.push(...xArr);
        if (config.multiLine) {
            config.yKeys.forEach(key => {
                allY.push(...(run[key] || []).filter(v => v !== null && v !== undefined));
            });
        } else {
            allY.push(...(run[config.yKey] || []).filter(v => v !== null && v !== undefined));
        }
    });

    if (allY.length === 0) return;

    const xMax = 200;
    allX = allX.filter(v => v <= xMax);
    allY = [];
    runs.forEach(run => {
        const xArr = run[stepsKey];
        if (!xArr || xArr.length === 0) return;
        if (config.multiLine) {
            config.yKeys.forEach(key => {
                const yArr = run[key] || [];
                xArr.forEach((x, i) => { if (x <= xMax && yArr[i] != null) allY.push(yArr[i]); });
            });
        } else {
            const yArr = run[config.yKey] || [];
            xArr.forEach((x, i) => { if (x <= xMax && yArr[i] != null) allY.push(yArr[i]); });
        }
        if (baseAnchor !== null) allY.push(baseAnchor);
    });

    const xScale = d3.scaleLinear().domain([d3.min(allX), xMax]).range([0, width]);

    let yMin = d3.min(allY), yMax_ = d3.max(allY);
    const yPad = (yMax_ - yMin) * 0.1 || 0.1;
    const yScale = config.logScale
        ? d3.scaleLog().domain([d3.min(allY.filter(v => v > 0)) * 0.5, d3.max(allY.filter(v => v > 0)) * 2]).range([height, 0]).nice()
        : d3.scaleLinear().domain([yMin - yPad, yMax_ + yPad]).range([height, 0]).nice();

    g.append('g').attr('class', 'grid').selectAll('line').data(yScale.ticks(4)).enter().append('line')
        .attr('x1', 0).attr('x2', width).attr('y1', d => yScale(d)).attr('y2', d => yScale(d))
        .attr('stroke', '#e5e7eb').attr('stroke-width', 1);

    g.append('g').attr('transform', `translate(0,${height})`)
        .call(d3.axisBottom(xScale).ticks(4).tickSize(0).tickPadding(6))
        .call(g => g.select('.domain').attr('stroke', '#d1d5db'))
        .call(g => g.selectAll('.tick text').attr('fill', '#6b7280').attr('font-size', '10px').attr('font-family', 'Source Code Pro, monospace'));

    const yAxis = config.logScale
        ? d3.axisLeft(yScale).ticks(3, '.0e').tickSize(0).tickPadding(6)
        : d3.axisLeft(yScale).ticks(4).tickSize(0).tickPadding(6);
    g.append('g').call(yAxis)
        .call(g => g.select('.domain').remove())
        .call(g => g.selectAll('.tick text').attr('fill', '#6b7280').attr('font-size', '10px').attr('font-family', 'Source Code Pro, monospace'));

    svg.append('text').attr('x', margin.left + width / 2).attr('y', 14)
        .attr('text-anchor', 'middle').attr('fill', '#1f2937').attr('font-size', '10px')
        .attr('font-weight', '600').attr('font-family', 'Lora, serif').text(config.title);

    const line = d3.line()
        .defined(d => d.y != null && (!config.logScale || d.y > 0))
        .x(d => xScale(d.x)).y(d => yScale(d.y))
        .curve(config.linear ? d3.curveLinear : d3.curveMonotoneX);

    const allLineData = [];
    const GRAY = '#d1d5db';

    // Draw in two passes: gray (non-highlighted) first, then colored (highlighted) on top
    const drawPass = (runSubset, isHighlighted) => {
        runSubset.forEach((run, runIdx) => {
            const xArr = run[stepsKey];
            if (!xArr || xArr.length === 0) return;
            const drawColor = isHighlighted ? run.color : GRAY;
            const drawWidth = isHighlighted ? 1.75 : 1;
            const drawOpacity = isHighlighted ? 0.9 : 0.35;

            if (config.multiLine) {
                config.yKeys.forEach((yKey, keyIdx) => {
                    const data = xArr.map((step, i) => ({ x: step, y: (run[yKey] || [])[i], label: run.label, metric: config.yLabels[keyIdx] }))
                        .filter(d => d.x <= xMax && d.y != null);
                    if (isHighlighted) allLineData.push({ data, color: run.color, label: run.label, metric: config.yLabels[keyIdx] });
                    g.append('path').datum(data).attr('fill', 'none').attr('stroke', drawColor)
                        .attr('stroke-width', drawWidth).attr('stroke-opacity', isHighlighted ? (keyIdx === 0 ? 0.9 : 0.5) : drawOpacity)
                        .attr('stroke-linecap', 'round').attr('stroke-linejoin', 'round').attr('d', line);
                });
            } else {
                let data = xArr.map((step, i) => ({ x: step, y: (run[config.yKey] || [])[i], label: run.label }))
                    .filter(d => d.x <= xMax && d.y != null && (!config.logScale || d.y > 0));
                if (baseAnchor !== null && data.length > 0) {
                    data = [{ x: 0, y: baseAnchor, label: 'Base model' }, ...data];
                }
                if (isHighlighted) allLineData.push({ data, color: run.color, label: run.label });
                g.append('path').datum(data).attr('fill', 'none').attr('stroke', drawColor)
                    .attr('stroke-width', drawWidth).attr('stroke-opacity', drawOpacity)
                    .attr('stroke-linecap', 'round').attr('stroke-linejoin', 'round').attr('d', line);
            }
        });
    };

    // Pass 1: non-highlighted (gray background)
    drawPass(runs.filter(r => !highlightedSet.has(r.id)), false);
    // Pass 2: highlighted (colored, on top)
    drawPass(runs.filter(r => highlightedSet.has(r.id)), true);

    // Tooltip interaction
    const tt = codeGetTooltip();
    const fmt = d3.format(config.format || '.3f');

    const hoverLine = g.append('line').attr('stroke', '#9ca3af').attr('stroke-width', 1)
        .attr('stroke-dasharray', '3,3').attr('y1', 0).attr('y2', height).style('opacity', 0);
    const hoverDots = g.append('g').attr('class', 'hover-dots');

    g.append('rect').attr('width', width).attr('height', height).attr('fill', 'transparent')
        .on('mousemove', function(event) {
            const [mx] = d3.pointer(event);
            const x0 = xScale.invert(mx);
            const bisect = d3.bisector(d => d.x).left;
            let html = `<strong>Step ${Math.round(x0)}</strong><br>`;
            hoverLine.attr('x1', mx).attr('x2', mx).style('opacity', 1);
            hoverDots.selectAll('circle').remove();
            allLineData.forEach(li => {
                const i = bisect(li.data, x0, 1);
                const d0 = li.data[i - 1], d1 = li.data[i];
                if (!d0 && !d1) return;
                const d = !d1 ? d0 : !d0 ? d1 : (x0 - d0.x > d1.x - x0 ? d1 : d0);
                if (d && d.y != null) {
                    const ml = li.metric ? ` (${li.metric})` : '';
                    html += `<span style="color:${li.color}"></span> ${li.label}${ml}: ${fmt(d.y)}<br>`;
                    hoverDots.append('circle').attr('cx', xScale(d.x)).attr('cy', yScale(d.y))
                        .attr('r', 4).attr('fill', li.color).attr('stroke', '#fff').attr('stroke-width', 1.5);
                }
            });
            tt.html(html).style('left', (event.pageX + 15) + 'px').style('top', (event.pageY - 10) + 'px').style('opacity', 1);
        })
        .on('mouseleave', function() {
            hoverLine.style('opacity', 0);
            hoverDots.selectAll('circle').remove();
            tt.style('opacity', 0);
        });
}

// --- Pass@k plot drawing ---
function codeDrawPassKPlot(container, runs, config, highlightedSet) {
    container.innerHTML = '';

    const margin = { top: 16, right: 12, bottom: 28, left: 44 };
    const width = 336 - margin.left - margin.right;
    const height = 192 - margin.top - margin.bottom;

    const svg = d3.select(container)
        .append('svg')
        .attr('viewBox', `0 0 ${width + margin.left + margin.right} ${height + margin.top + margin.bottom}`)
        .attr('preserveAspectRatio', 'xMidYMid meet');

    const g = svg.append('g')
        .attr('transform', `translate(${margin.left},${margin.top})`);

    // Collect all k values and rates (including base model)
    let allK = [];
    let allY = [];
    // Extract benchmark key from config (e.g. "passk_gsm8k_pass128_k" -> "gsm8k_pass128")
    const benchKey = config.kKey.replace('passk_', '').replace('_k', '');
    const basePassk = codeData.base_model && codeData.base_model.passk && codeData.base_model.passk[benchKey];
    if (basePassk) {
        allK.push(...basePassk.k);
        allY.push(...basePassk.rate);
    }
    runs.forEach(run => {
        const kArr = run[config.kKey];
        const rArr = run[config.rateKey];
        if (!kArr || !rArr) return;
        allK.push(...kArr);
        allY.push(...rArr.filter(v => v != null));
    });

    if (allY.length === 0) return;

    const kMin = d3.min(allK);
    const kMax = d3.max(allK);
    const xScale = d3.scaleLog().base(2).domain([kMin, kMax]).range([0, width]).nice();
    const yMin = d3.min(allY), yMax_ = d3.max(allY);
    const yPad = (yMax_ - yMin) * 0.1 || 0.01;
    const yScale = d3.scaleLinear().domain([Math.max(0, yMin - yPad), Math.min(1, yMax_ + yPad)]).range([height, 0]).nice();

    // Grid
    g.append('g').attr('class', 'grid').selectAll('line').data(yScale.ticks(4)).enter().append('line')
        .attr('x1', 0).attr('x2', width).attr('y1', d => yScale(d)).attr('y2', d => yScale(d))
        .attr('stroke', '#e5e7eb').attr('stroke-width', 1);

    // X axis (log2 ticks: 1, 2, 4, 8, 16, 32, 64, 128)
    const tickVals = [1, 2, 4, 8, 16, 32, 64, 128].filter(v => v >= kMin && v <= kMax);
    g.append('g').attr('transform', `translate(0,${height})`)
        .call(d3.axisBottom(xScale).tickValues(tickVals).tickFormat(d => d).tickSize(0).tickPadding(6))
        .call(g => g.select('.domain').attr('stroke', '#d1d5db'))
        .call(g => g.selectAll('.tick text').attr('fill', '#6b7280').attr('font-size', '10px').attr('font-family', 'Source Code Pro, monospace'));

    // Y axis
    g.append('g').call(d3.axisLeft(yScale).ticks(4).tickFormat(d3.format('.0%')).tickSize(0).tickPadding(6))
        .call(g => g.select('.domain').remove())
        .call(g => g.selectAll('.tick text').attr('fill', '#6b7280').attr('font-size', '10px').attr('font-family', 'Source Code Pro, monospace'));

    // Title
    svg.append('text').attr('x', margin.left + width / 2).attr('y', 14)
        .attr('text-anchor', 'middle').attr('fill', '#1f2937').attr('font-size', '10px')
        .attr('font-weight', '600').attr('font-family', 'Lora, serif').text(config.title);

    // X-axis label
    svg.append('text').attr('x', margin.left + width / 2).attr('y', height + margin.top + 28)
        .attr('text-anchor', 'middle').attr('fill', '#9ca3af').attr('font-size', '9px')
        .attr('font-family', 'Source Code Pro, monospace').text('k');

    const line = d3.line()
        .defined(d => d.y != null)
        .x(d => xScale(d.x)).y(d => yScale(d.y))
        .curve(d3.curveMonotoneX);

    const GRAY = '#d1d5db';
    const allLineData = [];

    const drawPass = (runSubset, isHighlighted) => {
        runSubset.forEach(run => {
            const kArr = run[config.kKey];
            const rArr = run[config.rateKey];
            if (!kArr || !rArr) return;
            const data = kArr.map((k, i) => ({ x: k, y: rArr[i], label: run.label }));
            const drawColor = isHighlighted ? run.color : GRAY;
            const drawWidth = isHighlighted ? 1.75 : 1;
            const drawOpacity = isHighlighted ? 0.9 : 0.35;
            if (isHighlighted) allLineData.push({ data, color: run.color, label: run.label });
            g.append('path').datum(data).attr('fill', 'none').attr('stroke', drawColor)
                .attr('stroke-width', drawWidth).attr('stroke-opacity', drawOpacity)
                .attr('stroke-linecap', 'round').attr('stroke-linejoin', 'round').attr('d', line);
        });
    };

    drawPass(runs.filter(r => !highlightedSet.has(r.id)), false);
    drawPass(runs.filter(r => highlightedSet.has(r.id)), true);

    // Draw base model line (dashed)
    if (basePassk) {
        const baseData = basePassk.k.map((k, i) => ({ x: k, y: basePassk.rate[i], label: codeData.base_model.label }));
        // Filter to same k range as trained models
        const filteredBase = baseData.filter(d => d.x >= kMin && d.x <= kMax);
        g.append('path').datum(filteredBase).attr('fill', 'none').attr('stroke', '#999')
            .attr('stroke-width', 1.5).attr('stroke-opacity', 0.7)
            .attr('stroke-dasharray', '4,3')
            .attr('stroke-linecap', 'round').attr('stroke-linejoin', 'round').attr('d', line);
        allLineData.push({ data: filteredBase, color: '#999', label: codeData.base_model.label });
    }

    // Tooltip
    const tt = codeGetTooltip();
    const fmt = d3.format(config.format || '.1%');

    const hoverLine = g.append('line').attr('stroke', '#9ca3af').attr('stroke-width', 1)
        .attr('stroke-dasharray', '3,3').attr('y1', 0).attr('y2', height).style('opacity', 0);
    const hoverDots = g.append('g').attr('class', 'hover-dots');

    g.append('rect').attr('width', width).attr('height', height).attr('fill', 'transparent')
        .on('mousemove', function(event) {
            const [mx] = d3.pointer(event);
            const x0 = xScale.invert(mx);
            const bisect = d3.bisector(d => d.x).left;
            let html = `<strong>k=${Math.round(x0)}</strong><br>`;
            hoverLine.attr('x1', mx).attr('x2', mx).style('opacity', 1);
            hoverDots.selectAll('circle').remove();
            allLineData.forEach(li => {
                const i = bisect(li.data, x0, 1);
                const d0 = li.data[i - 1], d1 = li.data[i];
                if (!d0 && !d1) return;
                const d = !d1 ? d0 : !d0 ? d1 : (x0 - d0.x > d1.x - x0 ? d1 : d0);
                if (d && d.y != null) {
                    html += `<span style="color:${li.color}"></span> ${li.label}: ${fmt(d.y)}<br>`;
                    hoverDots.append('circle').attr('cx', xScale(d.x)).attr('cy', yScale(d.y))
                        .attr('r', 4).attr('fill', li.color).attr('stroke', '#fff').attr('stroke-width', 1.5);
                }
            });
            tt.html(html).style('left', (event.pageX + 15) + 'px').style('top', (event.pageY - 10) + 'px').style('opacity', 1);
        })
        .on('mouseleave', function() {
            hoverLine.style('opacity', 0);
            hoverDots.selectAll('circle').remove();
            tt.style('opacity', 0);
        });
}

// Initialize
function codeInit() {
    codeBuildPresets();
    codeBuildLegend();
    if (codePresets.length > 0) {
        codeActivatePreset(codePresets[0].id);
    } else {
        codeRedraw();
    }
    codePopulateMetrics();
    codeGenerateTable();
}

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', codeInit);
} else {
    codeInit();
}
